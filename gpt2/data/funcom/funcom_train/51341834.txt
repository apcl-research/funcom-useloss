TDAT: final public void clear ( final boolean clear refs ) {  <NL>  <NL> lock . lock ( ) ;  <NL>  <NL> try {  <NL>  <NL> for ( batch queue < t > q : thread local queues . values ( ) ) {  <NL>  <NL>  / / clear the thread local queues .  <NL> q . clear ( clear refs ) ;  <NL>  <NL>  }  <NL>  <NL>  / / discard map entries .  <NL> thread local queues . clear ( ) ;  <NL>  <NL>  / / clear the shared backing queue .  <NL> shared queue . clear ( true / * clear refs * / ) ;  <NL>  <NL>  } finally {  <NL>  <NL> lock . unlock ( ) ;  <NL>  <NL>  }  <NL>  <NL>  }  COM: <s> discards the thread local buffers and clears the backing ring buffer </s>