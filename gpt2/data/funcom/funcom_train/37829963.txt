TDAT: public void on action ( final player player , final rp action action ) {  <NL> if ( count buddies ( player ) > 500 ) {  <NL> player . send private text ( notification type . error , " sorry , you have already too many buddies " ) ;  <NL> return ;  <NL>  }  <NL>  <NL> final string who = action . get ( target ) ;  <NL>  <NL> db command command = new query canonical character names command ( player , arrays . as list ( who ) ) ;  <NL> db command queue . get ( ) . enqueue and await result ( command , handle ) ;  <NL> turn notifier . get ( ) . notify in turns ( 0 , new turn listener decorator ( this ) ) ;  <NL>  }  COM: <s> starts to handle a buddy action </s>