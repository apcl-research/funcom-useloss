TDAT: public segment cross segment ( ray r ) {  <NL> if ( r = = null ) return null ;  <NL>  <NL> double d2 , d2min = double . max _ value ;  <NL> segment cross segment = null ; ;  <NL>  <NL> iterator i = segments . iterator ( ) ;  <NL> while ( i . has next ( ) ) {  <NL> segment s = ( segment ) i . next ( ) ;  <NL> if ( r . cross ( s ) ) {  <NL> d2 = distance2 ( r , s ) ;  <NL> if ( d2 < d2min ) {  <NL> cross segment = s ;  <NL> d2min = d2 ;  <NL>  }  <NL>  }  <NL>  }  <NL> return cross segment ;  <NL>  }  COM: <s> returns the first intersection with the ray r </s>