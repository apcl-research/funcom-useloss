TDAT: public void attach ( ) {  <NL> m lock . lock ( ) ;  <NL> try {  <NL> if ( m txn mgr . set local scope ( this , m detached ) ) {  <NL> m detached = false ;  <NL>  } else if ( ! m detached ) {  <NL> throw new illegal state exception ( " transaction scope is not detached " ) ;  <NL>  } else {  <NL> throw new illegal state exception <NL>  ( " current thread has a different transaction already attached " ) ;  <NL>  }  <NL>  } finally {  <NL> m lock . unlock ( ) ;  <NL>  }  <NL>  }  COM: <s> attach this scope to the current thread if it has been </s>