TDAT: public int get character offset ( ) {  <NL> if ( f current entity ! = null ) {  <NL> if ( f current entity . is external ( ) ) {  <NL> return f current entity . base char offset + ( f current entity . position - f current entity . start position ) ;  <NL>  }  <NL> else {  <NL>  / / ask current entity to find appropriate character offset <NL> return f current entity . get character offset ( ) ;  <NL>  }  <NL>  }  <NL>  <NL> return - 1 ;  <NL>  } / / get character offset ( ) : int  COM: <s> returns the character offset where the current document event ends </s>