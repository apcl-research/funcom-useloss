TDAT: protected int next in entity value ( ) throws io exception , xml exception {  <NL> switch ( current ) {  <NL> case ' & ' :  <NL> return read reference ( ) ;  <NL>  <NL> case ' % ' :  <NL> int t = next char ( ) ;  <NL> read name ( lexical units . parameter _ entity _ reference ) ;  <NL> if ( current ! = ' ; ' ) {  <NL> throw create xml exception ( " invalid . parameter . entity " ) ;  <NL>  }  <NL> next char ( ) ;  <NL> return t ;  <NL>  <NL> default :  <NL> while ( current ! = - 1 & &  <NL> current ! = attr delimiter & &  <NL> current ! = ' & ' & &  <NL> current ! = ' % ' ) {  <NL> next char ( ) ;  <NL>  }  <NL> switch ( current ) {  <NL> case - 1 :  <NL> throw create xml exception ( " unexpected . eof " ) ;  <NL>  <NL> case ' \ ' ' :  <NL> case ' " ' :  <NL> next char ( ) ;  <NL> context = entity _ context ;  <NL> return lexical units . string ;  <NL>  }  <NL> return lexical units . first _ attribute _ fragment ;  <NL>  }  <NL>  }  COM: <s> returns the next lexical unit in the context of an entity value </s>