TDAT: public r3 cartesian2spherical ( ) {  <NL> double r _ 2 = x1 * x1 + x2 * x2 ;  <NL> double r = math . sqrt ( r _ 2 ) ;  <NL> double r = math . sqrt ( r _ 2 + x3 * x3 ) ;  <NL> double theta = math . atan2 ( x3 , r ) ;  <NL> double phi = math . atan2 ( x2 , x1 ) ;  <NL>  <NL> return new r3 ( r , theta , phi ) ;  <NL>  }  COM: <s> apply coordinate transform from cartesian to spherical coordinates </s>