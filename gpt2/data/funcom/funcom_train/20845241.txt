TDAT: private void set preferred version ( string communication manager id ) {  <NL> communication manager com man = dpws framework . get communication manager ( communication manager id ) ;  <NL> hash set supported versions = com man . get supported versions ( ) ;  <NL> if ( supported versions . size ( ) = = 1 ) {  <NL> if ( preferred x address info = = null ) {  <NL> preferred x address info = new x address info ( ) ;  <NL>  }  <NL> integer ver = ( integer ) ( supported versions . to array ( ) [ 0 ] ) ;  <NL> preferred x address info . set protocol info ( com man . create protocol info ( ver . int value ( ) ) ) ;  <NL>  }  <NL>  }  COM: <s> set the preferred protocol version to the dpwsversion of the dpwsproperties </s>