TDAT: public big decimal probability ( ) {  <NL>  <NL> big decimal prob = big decimal . value of ( 1 . 0 ) ;  <NL>  <NL> r r = recursion config ;  <NL>  <NL> for ( br event < e , m , d , s , r > event : recursion chain ) {  <NL>  <NL> r ancestral config = event . get config ( ) ;  <NL>  <NL> e type = event . get type ( ) ;  <NL>  <NL> prob = prob . multiply ( recursion config . transition prob ( type , ancestral config ) ) ;  <NL>  <NL> r = ancestral config ;  <NL>  }  <NL>  <NL> return prob ;  <NL>  }  COM: <s> the probability of this genealogy </s>