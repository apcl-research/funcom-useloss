TDAT: public void read ( buffer buf ) throws io exception {  <NL> byte [ ] image = consume image ( ) ;  <NL>  <NL>  / / check if we ' ve finished all the frames .  <NL> if ( image = = null ) {  <NL>  / / we are done . set end of media .  <NL> buf . set eom ( true ) ;  <NL> buf . set offset ( 0 ) ;  <NL> buf . set length ( 0 ) ;  <NL> ended = true ;  <NL> return ;  <NL>  }  <NL>  <NL> buf . set data ( image ) ;  <NL> buf . set offset ( 0 ) ;  <NL> buf . set length ( image . length ) ;  <NL> buf . set format ( format ) ;  <NL> buf . set flags ( buf . get flags ( ) | buffer . flag _ key _ frame ) ;  <NL>  }  COM: <s> this is called from the processor to read a frame worth of video </s>