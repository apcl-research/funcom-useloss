TDAT: protected int get record size ( int data _ size ) {  <NL> if ( active write state = = null ) {  <NL> return 5 + data _ size ; / / type + version + length + data _ size <NL>  } else {  <NL> int res = 5 + active write state . get fragment size ( data _ size ) ;  <NL> return ( res > max _ ciphered _ data _ length )  <NL>  ? max _ ciphered _ data _ length / / so the source data should be <NL>  / / splitted into several packets <NL>  : res ;  <NL>  }  <NL>  }  COM: <s> returns the record length for the specified incoming data length </s>