TDAT: public void calculate and add formula ( hydrogen control control ) {  <NL> list < cml molecule > molecules = this . get molecule elements ( ) ;  <NL> if ( molecules . size ( ) > 0 ) {  <NL> for ( cml molecule molecule1 : molecules ) {  <NL> molecule tool molecule tool1 = molecule tool . get or create tool ( molecule1 ) ;  <NL> molecule tool1 . calculate and add formula ( control ) ;  <NL>  }  <NL>  } else {  <NL> cml formula formula = null ;  <NL> formula = this . calculate formula ( control ) ;  <NL> molecule . append child ( formula ) ;  <NL>  }  <NL>  }  COM: <s> calculates formula for molecule or each molecule child </s>