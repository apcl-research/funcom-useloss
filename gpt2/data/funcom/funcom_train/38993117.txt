TDAT: public improvement type get random improvement type ( ) {  <NL> double pct = r . next double ( ) ;  <NL>  <NL> double total pct = 0 . 0 ;  <NL> for ( stats stat : type stats . values ( ) ) {  <NL> total pct + = stat . pct ;  <NL>  }  <NL>  <NL> for ( map . entry < improvement type , stats > entry : type stats . entry set ( ) ) {  <NL> stats stat = entry . get value ( ) ;  <NL> double type pct = stat . pct / total pct ;  <NL> if ( pct < = type pct )  <NL> return entry . get key ( ) ;  <NL>  <NL> pct - = type pct ;  <NL>  }  <NL>  <NL> return improvement type . complete change ;  <NL>  }  COM: <s> returns a random improvement type that is influenced by how successful the types </s>