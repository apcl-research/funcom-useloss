TDAT: public int first parent with code ( final int pos , final int link code ) {  <NL> int ctx = _ dests [ word context lin ( pos ) ] ; / / first parent of text node <NL> final int shift = _ n text nodes ;  <NL> final int limit = _ dests . length - 1 ;  <NL> while ( _ link types [ ctx - shift ] ! = link code )  <NL> if ( ( ctx = _ dests [ ctx ] ) = = limit )  <NL> return - 1 ;  <NL> return ctx ;  <NL>  }  COM: <s> starting with ctx and going up the ancestry tree look for the first </s>