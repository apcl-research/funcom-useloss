TDAT: private int position to index ( tree position pos ) {  <NL> if ( path = = null )  <NL> return - 1 ;  <NL>  <NL> boolean included = false ;  <NL> int acc = 0 ;  <NL> tree node node = null ;  <NL> boolean up = false ;  <NL> for ( int i = 0 ; i < node path . size ( ) ; i + + ) {  <NL> node = node path . get ( i ) . node ;  <NL> if ( node = = pos . node ) {  <NL> included = true ;  <NL> up = node path . get ( i ) . up ;  <NL> break ;  <NL>  }  <NL> acc + = node . get events ( ) . length ;  <NL>  }  <NL>  <NL> if ( ! included )  <NL> return - 1 ;  <NL>  <NL> int res = node . position to index ( pos . position ) ;  <NL> if ( up )  <NL> res = node . get events ( ) . length - res - 1 ;  <NL> return acc + res ;  <NL>  }  COM: <s> converts a position on the tree to an index on the event path </s>