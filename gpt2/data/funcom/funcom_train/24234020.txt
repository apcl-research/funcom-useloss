TDAT: protected void flush ( ) throws interrupted exception {  <NL> if ( ! active ) return ;  <NL> final long seq no = sender . get current sequence number ( ) ;  <NL> if ( seq no < 0 ) throw new illegal state exception ( ) ;  <NL> while ( ! sender . is sent out ( seq no ) ) {  <NL> thread . sleep ( 5 ) ;  <NL>  }  <NL> if ( seq no > - 1 ) {  <NL>  / / wait until data has been sent out and acknowledged <NL> while ( active & & ! sender . have acknowledgement for ( seq no ) ) {  <NL> sender . wait for ack ( seq no ) ;  <NL>  }  <NL>  }  <NL>  / / todo need to check if we can pause the sender . . .  <NL>  / / sender . pause ( ) ;  <NL>  }  COM: <s> will block until the outstanding packets have really been sent out </s>