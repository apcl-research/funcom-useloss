TDAT: protected double compute ( double x , double c , double t , double w ) {  <NL> double alpha = 0 . 69314718 / math . log ( 1 . 0 + w / 2 . 9979e5 / 2 . 0 ) ;  <NL> if ( alpha < = 1 . 0 )  <NL> alpha = 1 . 0001 ;  <NL> if ( x > = c )  <NL> alpha = - alpha ;  <NL> double value = t * math . pow ( ( x / c ) , alpha ) ;  <NL> return math . exp ( - value ) ;  <NL>  }  COM: <s> computes log absorption in optical depth </s>