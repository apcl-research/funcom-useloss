TDAT: public void calc improper terminating markings ( ) {  <NL> if ( improper terminating markings ! = null )  <NL> return ;  <NL>  <NL> improper terminating markings = new hash set < marking > ( ) ;  <NL>  <NL> for ( marking marking : rg . get markings ( ) ) {  <NL>  / / if end marking have token and end marking doesn ' t have all tokens <NL>  / / of the net <NL> if ( marking . get num tokens ( net . get final place ( ) ) > 0 <NL>  & & marking . get num tokens ( net . get final place ( ) ) ! = marking . get num tokens ( ) ) {  <NL> improper terminating markings . add ( marking ) ;  <NL>  }  <NL>  }  <NL>  }  COM: <s> calculates markings which have token in end state and in other states </s>