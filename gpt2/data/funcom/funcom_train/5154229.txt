TDAT: public double fisher exact test up ( int k , int n , int d , int n ) {  <NL> if ( k = = 0 ) return 1 ; / / this line speeds up a lot of cases <NL>  <NL> double cumulative hg = 0 ;  <NL> int max test = math . min ( n , d ) ;  <NL> for ( int i = k ; i < = max test ; i + + )  <NL> cumulative hg + = hd . hypergeometric ( i , n , d , n ) ;  <NL>  <NL> return math . min ( cumulative hg , 1 . 0 ) ;  <NL>  }  COM: <s> fishers exact test for k or more upper tail </s>