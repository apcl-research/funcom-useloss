TDAT: protected void postal delivery ( ) {  <NL> while ( true ) {  <NL> message received . p ( ) ;  <NL>  <NL> packet p = machine . network link ( ) . receive ( ) ;  <NL>  <NL> mail message mail ;  <NL>  <NL> try {  <NL> mail = new mail message ( p ) ;  <NL>  }  <NL> catch ( malformed packet exception e ) {  <NL> continue ;  <NL>  }  <NL>  <NL> if ( lib . test ( dbg net ) )  <NL> system . out . println ( " delivering mail to port " + mail . dst port <NL>  + " : " + mail ) ;  <NL>  <NL>  / / atomically add message to the mailbox and wake a waiting thread <NL> queues [ mail . dst port ] . add ( mail ) ;  <NL>  }  <NL>  }  COM: <s> wait for incoming messages and then put them in the correct mailbox </s>