TDAT: public vector get smooth gradient ( vector p ) {  <NL> int x = find x ( p . x ) ;  <NL> int y = find y ( p . y ) ;  <NL>  <NL> int x0 = restrict x ( x - 1 ) ;  <NL> int x1 = restrict x ( x + 1 ) ;  <NL> int y0 = restrict y ( y - 1 ) ;  <NL> int y1 = restrict y ( y + 1 ) ;  <NL>  <NL> double dx = read data [ x1 ] [ y ] - read data [ x0 ] [ y ] ;  <NL> double dy = read data [ x ] [ y1 ] - read data [ x ] [ y0 ] ;  <NL>  <NL> return new vector ( dx / ( 2 * x step ) , dy / ( 2 * y step ) , 0 ) ;  <NL>  }  COM: <s> returns a smooth gradient at the given point </s>