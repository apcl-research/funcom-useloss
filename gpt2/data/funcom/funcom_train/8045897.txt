TDAT: public void close ( ) {  <NL> if ( out . is closed ( ) ) throw new illegal state exception ( " already closed " ) ;  <NL>  <NL>  / / verify that a root element has been written and not yet ended .  <NL> if ( state = = state . in _ prolog ) bad state ( " close " ) ;  <NL>  <NL>  / / end all the unended elements .  <NL> while ( current element metadata ! = null ) {  <NL> end ( ) ;  <NL>  }  <NL>  <NL> if ( add final newline ) { out . writeln ( ) ; }  <NL>  <NL> out . close ( ) ;  <NL>  }  COM: <s> terminates all unterminated elements closes the writer that is being </s>