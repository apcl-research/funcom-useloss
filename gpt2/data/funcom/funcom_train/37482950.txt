TDAT: static public direction get random direction ( int l , int m ) {  <NL> double _ x , test , leg ;  <NL> do {  <NL>  _ x = 1 - 2 * random . next ( ) ; / / - 1 . . 1 , x = cos ( theta )  <NL> test = random . next ( ) ; / / 0 . . 1 <NL> leg = evaluate legendre ( l , m , _ x ) ;  <NL>  } while ( test > ( leg * leg ) ) ;  <NL> return new direction ( amount . value of ( math . acos ( _ x ) , si . radian ) ,  <NL> random phi ( ) ) ;  <NL>  }  COM: <s> generate a random direction using a spherical harmonic distribution </s>