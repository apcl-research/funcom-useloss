TDAT: protected void flatten impl ( nsof object object , output stream out ) throws io exception {  <NL> if ( object = = null ) {  <NL> newton streamed object format . htonl ( 0 , out ) ;  <NL>  } else {  <NL> if ( precedents use & & ( object instanceof precedent ) ) {  <NL> precedent p = ( precedent ) object ;  <NL> nsof precedent id = precedents . get ( p ) ;  <NL> if ( id = = null ) {  <NL> id = new nsof precedent ( this . id max + + ) ;  <NL> precedents . put ( p , id ) ;  <NL>  } else {  <NL> object = id ;  <NL>  }  <NL>  }  <NL> object . flatten ( out , this ) ;  <NL>  }  <NL>  }  COM: <s> encode the newton script object implementation </s>