TDAT: public void fire before ( state s , int pc ) {  <NL> long cycles = simulator . get state ( ) . get cycles ( ) - last change ;  <NL> if ( cycles > 0 ) {  <NL> if ( current mode ! = null ) {  <NL>  / / system not sleeping <NL> current mode . cycles + = cycles ;  <NL>  } else {  <NL>  / / system sleeping <NL> sleep cycles + = cycles ;  <NL>  }  <NL>  }  <NL> last change = simulator . get state ( ) . get cycles ( ) ;  <NL> current mode = null ;  <NL>  }  COM: <s> fired before a sleep mode is entered it logs the previos state </s>