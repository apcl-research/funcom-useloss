TDAT: public void update presence ( presence p ) {  <NL> if ( presence . t _ unavailable . equals ( p . get attribute ( stanza . att _ type ) ) ) {  <NL> string offline resource = contact . resource ( p <NL>  . get attribute ( stanza . att _ from ) ) ;  <NL> if ( offline resource . compare to ( nick ) = = 0 ) {  <NL> availability = av _ unavailable ;  <NL> this . resources = null ;  <NL>  } else {  <NL> update existing presence ( p ) ;  <NL>  }  <NL> return ;  <NL>  } else {  <NL>  / / available presence , update the list and resort <NL> if ( resources = = null ) {  <NL>  / / first resource create the list <NL> resources = new presence [ ] { p } ;  <NL>  } else {  <NL>  <NL> add presence ( p ) ;  <NL>  }  <NL> availability = av _ online ;  <NL>  }  <NL>  }  COM: <s> update the presence for the resource that has sent it </s>