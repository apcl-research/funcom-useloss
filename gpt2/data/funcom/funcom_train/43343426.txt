TDAT: protected void prepare response ( ) {  <NL>  / / get dh offset <NL> int dh offset = - 1 ;  <NL> switch ( validation scheme ) {  <NL> case 1 :  <NL> dh offset = get dh offset1 ( ) ;  <NL> break ;  <NL> default :  <NL> log . debug ( " scheme 0 will be used for dh offset " ) ;  <NL> case 0 :  <NL> dh offset = get dh offset0 ( ) ;  <NL>  }  <NL>  / / create keypair <NL> key pair keys = generate key pair ( ) ;  <NL>  / / get public key <NL> byte [ ] public key = get public key ( keys ) ;  <NL>  / / add to handshake bytes <NL> system . arraycopy ( public key , 0 , handshake bytes , dh offset , 128 ) ;  <NL>  }  COM: <s> gets the dh offset in the handshake bytes array based on validation scheme </s>