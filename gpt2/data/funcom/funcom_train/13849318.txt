TDAT: public void snapshot ( ) throws io exception {  <NL> int old version = version ;  <NL> version + + ;  <NL>  <NL> string fname = version name ( snapshot prefix ) ;  <NL> file snapshot file = new file ( fname ) ;  <NL> file output stream out = new file output stream ( snapshot file ) ;  <NL> try {  <NL> try {  <NL> handler . snapshot ( out ) ;  <NL>  / * force contents to disk * /  <NL> out . get fd ( ) . sync ( ) ;  <NL>  } catch ( exception e ) {  <NL> throw new log exception ( " snapshot failed " , e ) ;  <NL>  }  <NL> snapshot bytes = snapshot file . length ( ) ;  <NL>  } finally {  <NL> out . close ( ) ;  <NL>  }  <NL>  <NL> log bytes = 0 ;  <NL> open log file ( ) ;  <NL> write version file ( ) ;  <NL> delete snapshot ( old version ) ;  <NL> delete log file ( old version ) ;  <NL>  }  COM: <s> records the client defined current snapshot by invoking the client </s>