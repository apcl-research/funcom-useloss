TDAT: private int calc join weight shift ( int [ ] join weights ) {  <NL> int first = join weights [ 0 ] ;  <NL> for ( int i = 1 ; i < join weights . length ; i + + ) {  <NL> if ( join weights [ i ] ! = first ) {  <NL> return 0 ;  <NL>  }  <NL>  }  <NL>  <NL> int divisor = 65536 / first ;  <NL> if ( divisor = = 2 ) {  <NL> return 1 ;  <NL>  } else if ( divisor = = 4 ) {  <NL> return 2 ;  <NL>  }  <NL> return 0 ;  <NL>  }  COM: <s> calculates the join weight shift </s>