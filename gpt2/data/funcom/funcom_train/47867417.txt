TDAT: protected mnp link transfer packet create lt ( input stream data , int length ) throws io exception {  <NL> if ( data = = null )  <NL> return null ;  <NL> mnp link transfer packet packet = create lt send ( ) ;  <NL> length = math . min ( length , mnp link transfer packet . max _ data _ length ) ;  <NL> if ( length > 0 ) {  <NL> byte [ ] buf = new byte [ length ] ;  <NL> int count = 0 ;  <NL> int offset = 0 ;  <NL> do {  <NL> count = data . read ( buf , offset , length ) ;  <NL> if ( count = = - 1 )  <NL> break ;  <NL> offset + = count ;  <NL> length - = count ;  <NL>  } while ( length > 0 ) ;  <NL> packet . set data ( buf , 0 , offset ) ;  <NL>  }  <NL> return packet ;  <NL>  }  COM: <s> create a link transfer packet </s>