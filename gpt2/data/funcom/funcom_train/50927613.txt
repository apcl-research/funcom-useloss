TDAT: public void calculate bonded atoms ( ) {  <NL> for ( cml molecule mol : molecule . get descendants or molecule ( ) ) {  <NL> list < cml atom > atoms = mol . get atoms ( ) ;  <NL>  / / need to remove old bonds first <NL> for ( cml bond bond : mol . get bonds ( ) ) {  <NL> bond . detach ( ) ;  <NL>  }  <NL> cml bond array ba = mol . get bond array ( ) ;  <NL> if ( ba ! = null ) {  <NL> ba . index bonds ( ) ;  <NL>  }  <NL> calculate bonded atoms ( atoms , mol ) ;  <NL>  }  <NL>  }  COM: <s> calculates which atoms are bonded by covalent radius criterion </s>