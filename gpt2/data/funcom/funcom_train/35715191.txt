TDAT: private i region to char region ( i line range lines ) throws bad location exception {  <NL> i document document = f viewer . get document ( ) ;  <NL> int offset = document . get line offset ( lines . get start line ( ) ) ;  <NL> int next line = end ( lines ) ;  <NL> int end offset ;  <NL> if ( next line > = document . get number of lines ( ) )  <NL> end offset = document . get length ( ) ;  <NL> else <NL> end offset = document . get line offset ( next line ) ;  <NL> return new region ( offset , end offset - offset ) ;  <NL>  }  COM: <s> returns the character offset based region of a line range </s>