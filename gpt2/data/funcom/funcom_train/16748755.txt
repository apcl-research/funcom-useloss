TDAT: public i document get active document ( ) {  <NL> i document doc = null ;  <NL> i workbench window my wbw = get active workbench window ( ) ;  <NL>  <NL> if ( my wbw ! = null ) {  <NL>  / / get the current command service of the used editor <NL> i editor part target editor = my wbw . get active page ( ) . get active editor ( ) ;  <NL>  <NL> if ( target editor instanceof i text editor ) {  <NL> doc = ( ( i text editor ) target editor ) . get document provider ( ) . get document ( target editor . get editor input ( ) ) ;  <NL>  }  <NL>  }  <NL> return doc ;  <NL>  }  COM: <s> this method determines the currently opened idocument </s>