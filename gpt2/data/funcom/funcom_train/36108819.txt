TDAT: public void build solver ( calculator calculator ) {  <NL> if ( solver = = null ) solver = create solver ( ) ;  <NL> remove blocks from macro solver ( ) ;  <NL> if ( solver instanceof default macro solver ) {  <NL>  ( ( default macro solver ) solver ) . set calculator ( calculator ) ;  <NL>  } / / else solver will be with out of calculator and someone should set it at other place .  <NL> solver . set shared parameter storage ( parameter storage ) ; / / should be done before adding blocks .  <NL> for ( external module bridge block : get list of blocks ( ) )  <NL> solver . add block ( block ) ;  <NL>  / / now macro solver is created .  <NL>  }  COM: <s> creating macro solver of system </s>