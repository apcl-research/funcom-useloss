TDAT: private double fun fit ( double [ ] q ) {  <NL> double rw = function squared . calculate win radius squared ( q ) ;  <NL> double rl = function squared . calculate max radius ( q ) ;  <NL> double cos = cos ( 0 . 5 * pi * math . sqrt ( rw / rl ) ) ;  <NL> return cos * cos ;  <NL>  / / return function squared . is window exist ( q ) ? 1 : 0 ;  <NL>  }  COM: <s> function guarantee smooth transition from wall to wall and window </s>