TDAT: protected void compute curv colors ( ) {  <NL>  <NL> need curv feature size ( ) ;  <NL> float cscale = parent . sq ( 8 . 0f * curv feature size ) ;  <NL>  <NL> int nv = vertices . size ( ) ;  <NL> curv colors = new p vector [ nv ] ;  <NL>  <NL> for ( int i = 0 ; i < nv ; i + + ) {  <NL> float h = 0 . 5f * ( curv1 [ i ] + curv2 [ i ] ) ;  <NL> float k = curv1 [ i ] * curv2 [ i ] ;  <NL> float h = 4 . 0f / 3 . 0f * math . abs ( ( float ) math . atan2 ( h * h - k , h * h * sgn ( h ) ) ) ;  <NL> float s = parent . two _ pi * ( float ) math . atan ( ( 2 . 0f * h * h - k ) * cscale ) ;  <NL> curv colors [ i ] = hsv ( h , s , 1 . 0f ) ;  <NL>  }  <NL>  }  COM: <s> color the mesh by curvatures </s>