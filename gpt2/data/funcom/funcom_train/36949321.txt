TDAT: protected void collect all subfolders ( i folder folder , array list collection ) throws ruby model exception {  <NL> try {  <NL> i resource [ ] members = folder . members ( ) ;  <NL> for ( int i = 0 , max = members . length ; i < max ; i + + ) {  <NL> i resource r = members [ i ] ;  <NL> if ( r . get type ( ) = = i resource . folder ) {  <NL> collection . add ( r ) ;  <NL> collect all subfolders ( ( i folder ) r , collection ) ;  <NL>  }  <NL>  }  <NL>  } catch ( core exception e ) {  <NL> throw new ruby model exception ( e ) ;  <NL>  }  <NL>  }  COM: <s> recursively adds all subfolders of code folder code to the given collection </s>