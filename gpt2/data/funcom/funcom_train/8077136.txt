TDAT: protected int range single ( string single ) {  <NL>  <NL> if ( single . to lower case ( ) . equals ( " first " ) ) {  <NL> return 0 ;  <NL>  }  <NL> if ( single . to lower case ( ) . equals ( " last " ) ) {  <NL> return m _ upper ;  <NL>  }  <NL> int index = integer . parse int ( single ) - 1 ;  <NL> if ( index < 0 ) {  <NL> index = 0 ;  <NL>  }  <NL> if ( index > m _ upper ) {  <NL> index = m _ upper ;  <NL>  }  <NL> return index ;  <NL>  }  COM: <s> translates a single string selection into its internal 0 based equivalent </s>