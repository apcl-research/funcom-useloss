TDAT: public char get allele at snp ( int individual index , int position ) {  <NL> byte [ ] nucs = m legend . get nucleotides in map ( m chrom num , position ) ;  <NL> if ( nucs = = null ) {  <NL> return affy snp map . nucleotide map [ 0 ] ;  <NL>  } else {  <NL> int snp index = m legend . get index of position in map ( m chrom num , position ) ;  <NL> int the index = m phase data . get ( individual index ) . get ( snp index ) ? 1 : 0 ;  <NL> return affy snp map . get nucleotide for integer ( nucs [ the index ] ) ;  <NL>  }  <NL>  }  COM: <s> given an individual and a position this returns the allele at that position </s>