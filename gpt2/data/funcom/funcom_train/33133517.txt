TDAT: public void attach to runner ( vat runner new runner ) {  <NL> synchronized ( attachment lock ) {  <NL> synchronized ( state lock ) {  <NL> if ( runner ! = null ) {  <NL> throw new illegal state exception (  <NL>  " the vat is already attached to the runner " ) ;  <NL>  }  <NL> switch ( state ) {  <NL> case running :  <NL> case enqueued :  <NL> case detaching :  <NL> throw new illegal state exception (  <NL>  " the vat is in invalid state : " + state ) ;  <NL> default :  <NL> break ;  <NL>  }  <NL> runner = new runner ;  <NL> if ( state = = vat state . pending ) {  <NL> enqueue vat ( ) ;  <NL>  }  <NL>  }  <NL>  }  <NL>  }  COM: <s> attach to runner </s>