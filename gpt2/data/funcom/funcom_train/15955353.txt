TDAT: public state vertex deep clone ( state machine global level , region region , composite state container ) {  <NL> default shallow history state l new = new default shallow history state ( f name , f behavior ,  <NL> f index , f global index ,  <NL> global level , region , container ,  <NL> f incomming , f outgoing ,  <NL> f kind ) ;  <NL>  / * attach to global * /  <NL> global level . make global index ( l new ) ;  <NL> return l new ;  <NL>  }  COM: <s> clones this shallow history state and replaces sub machine states with referenced sm </s>