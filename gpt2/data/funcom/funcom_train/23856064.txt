TDAT: protected double entropy ( collection < hierarchical cluster node < molecule > > clusters ) {  <NL> int overall size = root1 . get cluster size ( ) ;  <NL> double ret val = 0 ;  <NL>  <NL> for ( hierarchical cluster node < molecule > node : clusters ) {  <NL> int ai = node . get structures in leafs ( ) . size ( ) ;  <NL> double normalised ai = ( double ) ai / overall size ;  <NL>  <NL> ret val + = normalised ai * math . log ( normalised ai ) ;  <NL>  }  <NL>  <NL> return - ret val ;  <NL>  }  COM: <s> calculates the entropy of the clusters </s>