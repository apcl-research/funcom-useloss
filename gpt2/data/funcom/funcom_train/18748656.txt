TDAT: public state set active state ( state state ) {  <NL> state result = active state ;  <NL> active state = state ;  <NL> set < j cell > changed cells = new hash set < j cell > ( ) ;  <NL> if ( state ! = null ) {  <NL> changed cells . add ( get j cell ( state ) ) ;  <NL>  }  <NL> if ( result ! = null ) {  <NL> changed cells . add ( get j cell ( result ) ) ;  <NL>  }  <NL> refresh ( changed cells ) ;  <NL> return result ;  <NL>  }  COM: <s> sets the active state to a new value </s>