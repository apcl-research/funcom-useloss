TDAT: protected i text region determine text region ( i structured document document , i text region collection region collection , int offset ) {  <NL> i text region text region ;  <NL>  / / in case we are at the end of the document , asking for completion <NL> if ( offset = = document . get length ( ) ) {  <NL> text region = region collection . get last region ( ) ;  <NL>  } else {  <NL> text region = region collection . get region at character offset ( offset ) ;  <NL>  }  <NL> return text region ;  <NL>  }  COM: <s> determines the text region from the text region collection and offset </s>