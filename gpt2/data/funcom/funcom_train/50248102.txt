TDAT: protected int search for closing peer ( int offset , int opening peer , int closing peer , i document document ) throws io exception {  <NL>  <NL> f reader . configure forward reader ( document , offset + 1 , document . get length ( ) , true , true ) ;  <NL>  <NL> int stack = 1 ;  <NL> int c = f reader . read ( ) ;  <NL> while ( c ! = python code reader . eof ) {  <NL> if ( c = = opening peer & & c ! = closing peer )  <NL> stack + + ;  <NL> else if ( c = = closing peer )  <NL> stack - - ;  <NL>  <NL> if ( stack = = 0 )  <NL> return f reader . get offset ( ) ;  <NL>  <NL> c = f reader . read ( ) ;  <NL>  }  <NL>  <NL> return - 1 ;  <NL>  }  COM: <s> seaches for the closing peer relative to the starting offset </s>