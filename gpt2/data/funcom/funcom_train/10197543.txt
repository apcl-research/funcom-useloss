TDAT: protected collection flatten collection ( collection collection ) {  <NL> if ( flatten ) {  <NL> for ( iterator iterator = collection . iterator ( ) ; iterator . has next ( ) ; ) {  <NL> object obj = iterator . next ( ) ;  <NL> if ( obj instanceof abstract persistent object ) {  <NL> flatten persistent ( ( ( abstract persistent object ) obj ) ) ;  <NL>  }  <NL>  }  <NL>  }  <NL> return collection ;  <NL>  }  COM: <s> optionally flattens collection of abstract persistent object instances </s>