TDAT: public void open macro ( macro macro ) {  <NL> string all xml = get xml ( ) ;  <NL> string header = all xml . substring ( 0 , all xml . index of ( " < construction " ) ) ;  <NL> string footer = all xml . substring ( all xml . index of ( " < / construction > " ) , all xml . length ( ) ) ;  <NL> string builder sb = new string builder ( ) ;  <NL> macro . get xml ( sb ) ;  <NL> string macro xml = sb . to string ( ) ;  <NL> string new xml = header + macro xml . substring ( macro xml . index of ( " < construction " ) , macro xml . index of ( " < / construction > " ) ) + footer ;  <NL> this . macro = macro ;  <NL> set xml ( new xml , true ) ;  <NL>  }  COM: <s> switches the application to macro editing mode </s>