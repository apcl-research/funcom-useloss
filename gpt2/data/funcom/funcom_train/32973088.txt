TDAT: public void register ( rule rule ) {  <NL> if ( rule . type = = entity type . system ) {  <NL> all failures history = add to array ( all failures history , new failure history ( rule ) ) ;  <NL>  } else if ( rule . type = = entity type . ip ) {  <NL> ip thresholds = add to array ( ip thresholds , rule ) ;  <NL>  } else if ( rule . type = = entity type . machine ) {  <NL> machine thresholds = add to array ( machine thresholds , rule ) ;  <NL>  } else if ( rule . type = = entity type . user ) {  <NL> user thresholds = add to array ( user thresholds , rule ) ;  <NL>  }  <NL>  }  COM: <s> adds a new rule the manager </s>