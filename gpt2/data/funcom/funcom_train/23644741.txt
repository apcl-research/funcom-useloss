TDAT: public boolean is centred ( vec3 a ) {  <NL>  / / distance along normal to the ring <NL> double norm dist = math . abs ( m _ norm . mul ( sub ( a ) ) ) ;  <NL>  / / radius of the ring <NL> double radius = distance ( m _ atoms . get ( 0 ) ) ;  <NL>  / / distance from the centre to the atom <NL> double centre dist = distance ( a ) ;  <NL>  / / allow 1 angstrom across the border of the ring <NL> return centre dist * centre dist - norm dist * norm dist < ( radius + 1 ) * ( radius + 1 ) ;  <NL>  }  COM: <s> checks whether the atom is above the ring </s>