TDAT: protected void process message ( message packet ) throws unauthorized exception {  <NL>  / / ensure that connection was secured if tls was required <NL> if ( connection . get tls policy ( ) = = connection . tls policy . required & &  <NL>  ! connection . is secure ( ) ) {  <NL> close never secured connection ( ) ;  <NL> return ;  <NL>  }  <NL> router . route ( packet ) ;  <NL> session . increment client packet count ( ) ;  <NL>  }  COM: <s> process the received message packet </s>