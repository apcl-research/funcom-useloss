TDAT: public boolean do authenticate ( hash map user props ) throws exception {  <NL>  <NL> string n = ( string ) user props . get ( " username " ) ;  <NL> string p = ( string ) user props . get ( " password " ) ;  <NL>  <NL>  / / check username / password with db <NL> user u = new user dao ( ) . get ( n ) ;  <NL> if ( u ! = null ) {  <NL> string pwd = u . get password ( ) ;  <NL>  <NL>  / / authentication succeeded <NL> if ( check password ( p , pwd ) ) {  <NL> s log . debug ( " db authentication passed . . . " ) ;  <NL> set auth succeeded ( true ) ;  <NL> i external uid = u . get external unique id ( ) ;  <NL> set user ( n ) ;  <NL> return true ;  <NL>  }  <NL>  }  <NL>  <NL> return false ;  <NL>  }  COM: <s> perform actual authentication the user </s>