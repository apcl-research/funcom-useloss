TDAT: private double qsfn ( final double sinphi ) {  <NL> final double one _ es = 1 - excentricity squared ;  <NL>  <NL> if ( excentricity > = epsilon ) {  <NL> final double con = excentricity * sinphi ;  <NL>  <NL> return ( one _ es * ( ( sinphi / ( 1 . - ( con * con ) ) )  <NL>  - ( ( 0 . 5 / excentricity ) * math . log ( ( 1 . - con ) / ( 1 . + con ) ) ) ) ) ;  <NL>  } else {  <NL> return sinphi + sinphi ;  <NL>  }  <NL>  }  COM: <s> calculates q snyder equation 3 12 </s>