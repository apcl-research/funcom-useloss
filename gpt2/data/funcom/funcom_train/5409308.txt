TDAT: public boolean wait until queue empty ( long timeout ms ) {  <NL> long timeout at = system . current time millis ( ) ;  <NL> if ( timeout ms > = 0 )  <NL> timeout at + = timeout ms ;  <NL>  <NL> while ( true ) {  <NL> object task = m channel . peek ( ) ;  <NL> if ( task = = null )  <NL> return true ;  <NL> if ( timeout ms > = 0 ) {  <NL> long now = system . current time millis ( ) ;  <NL> if ( now > = timeout at )  <NL> return false ;  <NL>  }  <NL> try {  <NL> thread . sleep ( 100 ) ;  <NL>  } catch ( interrupted exception e ) { }  <NL>  }  <NL>  }  COM: <s> wait until task queue becomes empty </s>