TDAT: private void check cipher state ( ) {  <NL> if ( ! ( this instanceof null cipher ) ) {  <NL> if ( ! initialized ) {  <NL> throw new illegal state exception ( " cipher not initialized " ) ;  <NL>  }  <NL> if ( ( opmode ! = cipher . encrypt _ mode ) & &  <NL>  ( opmode ! = cipher . decrypt _ mode ) ) {  <NL> throw new illegal state exception ( " cipher not initialized " +  <NL>  " for encryption / decryption " ) ;  <NL>  }  <NL>  }  <NL>  }  COM: <s> ensures that cipher is in a valid state for update and do final </s>