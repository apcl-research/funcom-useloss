TDAT: public g person authenticate ( string userid , string password ) {  <NL>  <NL> if ( userid = = null||password = = null )  <NL> return null ;  <NL>  <NL> try {  <NL>  <NL> g person user = repository . get person ( userid ) ;  <NL> string crypt password = password ;  <NL> if ( user . get encryptiontype ( ) . equals ( g person . enc _ md5 ) ) {  <NL> crypt password = target utils . get md5 ( password ) ;  <NL>  }  <NL> user . set password ( crypt password ) ;  <NL> if ( repository . check internal ( user ) ) {  <NL> return user ;  <NL>  } else {  <NL> if ( repository . check external ( user ) ) {  <NL> return user ;  <NL>  }  <NL>  }  <NL>  <NL>  } catch ( exception e ) {  <NL> log . error ( e ) ;  <NL>  }  <NL>  <NL> return null ;  <NL>  <NL>  }  COM: <s> checks credentials against external and internal store </s>