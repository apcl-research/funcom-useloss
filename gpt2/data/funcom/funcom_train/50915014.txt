TDAT: private void parse moiety ( string formula string ) {  <NL> formula string = formula string . trim ( ) ;  <NL> string tokenizer st = new string tokenizer ( formula string , cml constants . s _ comma ) ;  <NL> if ( st . count tokens ( ) = = 1 ) {  <NL> parse moiety0 ( formula string ) ;  <NL>  } else {  <NL> while ( st . has more tokens ( ) ) {  <NL> cml formula sub form = new cml formula ( ) ;  <NL> string f = st . next token ( ) . trim ( ) ;  <NL> sub form . parse moiety0 ( f ) ;  <NL> this . append child ( sub form ) ;  <NL>  }  <NL>  }  <NL>  }  COM: <s> splits at commas </s>