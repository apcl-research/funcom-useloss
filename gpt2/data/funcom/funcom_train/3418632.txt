TDAT: public boolean commit ( ) throws login exception {  <NL>  <NL> if ( succeeded = = false ) {  <NL> return false ;  <NL>  } else {  <NL> if ( subject . is read only ( ) ) {  <NL> clean state ( ) ;  <NL> throw new login exception ( " subject is read - only " ) ;  <NL>  }  <NL>  / / add principals to the subject <NL> if ( ! subject . get principals ( ) . contains ( user ) ) {  <NL> subject . get principals ( ) . add ( user ) ;  <NL>  }  <NL>  <NL> if ( logger . debug on ( ) ) {  <NL> logger . debug ( " commit " ,  <NL>  " authentication has completed successfully " ) ;  <NL>  }  <NL>  }  <NL>  / / in any case , clean out state <NL> clean state ( ) ;  <NL> commit succeeded = true ;  <NL> return true ;  <NL>  }  COM: <s> complete user authentication authentication phase 2 </s>