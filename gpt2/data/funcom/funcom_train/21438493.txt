TDAT: public void undo ( ) throws exception {  <NL> if ( cur _ state < = 0 )  <NL> return ;  <NL>  <NL> doing = true ;  <NL> cur _ state - - ;  <NL> no _ actions - - ;  <NL> the doc . fill ( states . get ( cur _ state ) , ( no _ actions = = 0 & & ! was _ changed ) ) ;  <NL> doing = false ;  <NL>  <NL> fire undo redo action ( true ) ;  <NL>  }  COM: <s> restore the state of the underlying document if possible </s>