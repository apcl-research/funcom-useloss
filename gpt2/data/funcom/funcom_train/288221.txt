TDAT: public void do check ( object entity , action action ) {  <NL> principals allowed [ ] allowed = get principals allowed ( entity . get class ( ) ) ;  <NL>  / / no rights defined so ok <NL> if ( allowed . length = = 0 ) {  <NL>  / / todo throw ?  <NL> return ;  <NL>  }  <NL> list < principal > roles = jaas util . get roles ( ) ;  <NL> principal caller = jaas util . get principal ( ) ;  <NL> if ( ! has permissions ( roles , caller , entity , action , allowed ) ) {  <NL> throw new security exception ( action + " denied for " + entity ) ;  <NL>  }  <NL>  }  COM: <s> check insert update or remove permissions </s>