TDAT: public void event ( object source , string event name , object info ) {  <NL> if ( wire context . event _ close . equals ( event name ) ) {  <NL> if ( state = = state _ active ) {  <NL> commit ( ) ;  <NL>  } else {  <NL> rollback ( ) ;  <NL>  }  <NL>  <NL>  } else if ( default environment . event _ exception . equals ( event name ) ) {  <NL> set rollback only ( ) ;  <NL>  }  <NL>  }  COM: <s> this transaction will always listen to the close of the block context </s>