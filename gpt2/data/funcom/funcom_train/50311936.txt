TDAT: private string subst vars ( string text , text blocks vars , vector values ) {  <NL> string buffer retblock ;  <NL> string variable ;  <NL> int nvars ;  <NL> int i = 0 , beginpos = 0 , endpos = 0 ;  <NL>  <NL> if ( vars = = null )  <NL> return " " ;  <NL> nvars = vars . size ( ) ;  <NL> if ( nvars = = 0 )  <NL> retblock = new string buffer ( text ) ;  <NL> else {  <NL> retblock = new string buffer ( ) ;  <NL> while ( i < nvars ) {  <NL> beginpos = vars . begin offset at ( i ) ;  <NL> retblock . append ( text . substring ( endpos , beginpos ) ) ;  <NL> variable = ( string ) values . element at ( i ) ;  <NL> if ( variable ! = null )  <NL> retblock . append ( variable ) ;  <NL> endpos = vars . end offset at ( i ) + varend . length ( ) ;  <NL> i + + ;  <NL>  }  <NL> retblock . append ( text . substring ( endpos ) ) ;  <NL>  }  <NL> return retblock . to string ( ) ;  <NL>  }  COM: <s> used by subst block vars and subst trailer vars </s>