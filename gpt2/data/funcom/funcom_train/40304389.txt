TDAT: private vector3d class get bond normal ( atom a1 , atom a2 ) {  <NL> vector3d c = a1 . get coordinates ( ) ;  <NL> vector3d midpoint = c . plus ( a2 . get coordinates ( ) ) . times ( 0 . 5 ) ; / / middle of bond <NL> vector3d b = c . plus ( midpoint ) . times ( 0 . 5 ) ; / / middle of half - bond <NL> vector3d n = midpoint . minus ( c ) ; / / direction / length vector <NL> return new vector3d class ( n ) ;  <NL>  }  COM: <s> change graphics primitives only for those objects that have moved </s>