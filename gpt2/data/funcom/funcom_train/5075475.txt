TDAT: public void finalize record ( boolean eof ) throws io exception {  <NL> if ( ! file complete & & ! record complete ) {  <NL> int descriptor = desc _ code _ eor ;  <NL> if ( eof ) {  <NL> descriptor | = desc _ code _ eof ;  <NL> file complete = true ;  <NL>  }  <NL> write block ( descriptor , idx ) ;  <NL> record complete = true ;  <NL> idx = 0 ;  <NL>  }  <NL>  }  COM: <s> flushes the last dataset </s>