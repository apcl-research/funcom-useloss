TDAT: protected int calc factor ( symmetric matrix cov ) {  <NL> eigenvalue decomposition evd = new eigenvalue decomposition ( cov , true ) ;  <NL> evd . set errors control ( errors ) ;  <NL> diagonal matrix d = evd . get d ( ) ;  <NL> sort eigen ( null , d , d . get rows count ( ) ) ;  <NL> float tmp = sum _ var ;  <NL> sum _ var = d . trace ( ) ;  <NL> calc contribution ( d ) ;  <NL> sum _ var = tmp ;  <NL> for ( int i = 0 ; i < cumulative . get columns count ( ) ; + + i ) {  <NL> if ( cumulative . get ( i ) > = min cumulative - errors )  <NL> return i + 1 ;  <NL>  }  <NL> return cumulative . get columns count ( ) ;  <NL>  }  COM: <s> compute the factor from minimum cumulative contribution </s>