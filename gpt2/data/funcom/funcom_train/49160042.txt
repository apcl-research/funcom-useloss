TDAT: public lock lock ( int pid , lock type dependency ) throws unlockable exception {  <NL>  / / check the dependency status <NL> switch ( accept ( dependency ) ) {  <NL> case wait :  <NL> throw new unlockable exception (  <NL>  " cannot grant dependency % s for resource % s " , dependency ,  <NL> this ) ;  <NL> case error :  <NL> throw new runtime exception (  <NL> format ( " resource % s cannot accept dependency % s " , this ,  <NL> dependency ) ) ;  <NL> case ok _ lock :  <NL> return new file lock ( lockfile ) ;  <NL>  <NL> case ok _ status :  <NL> return new status lock ( pid . get pid ( ) ,  <NL> dependency = = lock type . write _ access ) ;  <NL> case go :  <NL>  <NL>  }  <NL>  <NL> return null ;  <NL>  <NL>  }  COM: <s> tries to lock the resource </s>