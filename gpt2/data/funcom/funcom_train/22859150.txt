TDAT: public double gamma ( double scale , double shape ) {  <NL> if ( shape = = math . floor ( shape ) ) {  <NL>  / / the shape is an integer <NL> double product = 1 . 0 ;  <NL> for ( long i = 0l ; i < shape ; i + + )  <NL> product * = source . sample ( ) ;  <NL>  <NL> return - scale * math . log ( product ) ;  <NL>  }  <NL>  / / not an integer <NL> if ( shape < 1 . 0 )  <NL> return scale * beta ( shape , 1 . 0 - shape ) * negexp ( 1 . 0 ) ;  <NL>  <NL>  / / shape > = 1 . 0 <NL> double floor = math . floor ( shape ) ;  <NL> return gamma ( scale , floor ) + gamma ( scale , shape - floor ) ;  <NL>  }  COM: <s> computes a gamma distribution </s>