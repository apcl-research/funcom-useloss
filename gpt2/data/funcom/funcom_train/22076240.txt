TDAT: public string instance ( map env ) {  <NL> string buffer sb = new string buffer ( ) ;  <NL> for ( iterator i = string . iterator ( ) ; i . has next ( ) ; ) {  <NL> fragment frag = ( fragment ) i . next ( ) ;  <NL> string rep = frag . instance ( env ) ;  <NL> if ( rep = = null ) {  <NL> if ( ! is ignore missing ( ) )  <NL> throw new illegal argument exception ( " variable " + frag . frag <NL>  + " has no value in environment " ) ;  <NL>  } else <NL> sb . append ( rep ) ;  <NL>  <NL>  }  <NL> return sb . to string ( ) ;  <NL>  }  COM: <s> instanciate this given variable string with an environment </s>