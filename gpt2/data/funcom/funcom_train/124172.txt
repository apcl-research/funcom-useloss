TDAT: public void set text carefully ( string text ) {  <NL>  <NL> int sel start = get selection start ( ) ;  <NL> int sel end = get selection end ( ) ;  <NL> int pos = get caret position ( ) ;  <NL>  <NL> set text ( text ) ;  <NL>  <NL> int ll = get text ( ) . length ( ) ;  <NL>  <NL>  / / set caret again .  <NL> if ( pos < ll )  <NL> set caret position ( pos ) ;  <NL>  <NL>  / / set selection again .  <NL> if ( sel start < ll )  <NL> set selection start ( sel start ) ;  <NL> if ( sel end < ll )  <NL> set selection end ( sel end ) ;  <NL> else <NL> set selection end ( ll ) ;  <NL> last valid text = get text ( ) ;  <NL>  <NL>  }  COM: <s> sets the text but preserves selection and caret position </s>