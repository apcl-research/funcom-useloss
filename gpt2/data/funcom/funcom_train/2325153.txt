TDAT: public int rank ( ) {  <NL> float eps = ( float ) math . pow ( 2 . 0 , - 23 . 0 ) ;  <NL> float tol = math . max ( m , n ) * elements s [ 0 ] * eps ;  <NL> int r = 0 ;  <NL> for ( int i = 0 ; i < elements s . length ; i + + ) {  <NL> if ( elements s [ i ] > tol ) {  <NL> r + + ;  <NL>  }  <NL>  }  <NL> return r ;  <NL>  }  COM: <s> returns the effective numerical matrix rank which is the number of </s>