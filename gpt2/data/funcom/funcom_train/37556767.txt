TDAT: public point get selection ( ) {  <NL> check widget ( ) ;  <NL> int [ ] start = new int [ 1 ] , end = new int [ 1 ] ;  <NL> os . send message ( handle , os . em _ getsel , start , end ) ;  <NL> if ( os . is db locale ) {  <NL> start [ 0 ] = mbcs to wcs pos ( start [ 0 ] ) ;  <NL> end [ 0 ] = mbcs to wcs pos ( end [ 0 ] ) ;  <NL>  }  <NL> return new point ( start [ 0 ] , end [ 0 ] ) ;  <NL>  }  COM: <s> gets the position of the selected text </s>