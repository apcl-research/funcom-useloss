TDAT: private void apply promotion ( ) {  <NL> int percent = promotion . promotion val1 ( ) ;  <NL>  <NL> promotion mod = context ( ) . sale mod ( ) ;  <NL> if ( mod = = null ) {  <NL> promotion markdown promotion = create markdown promotion ( percent ) ;  <NL> markdown promotion . set promotion string (  <NL> format . substitute (  <NL> promotion . promotion string ( ) , 1 ,  <NL> format . to money ( " " + promotion . promotion d val1 ( ) , context ( ) . locale ( ) ) ) ) ;  <NL> markdown promotion . set promotion no ( promotion . promotion no ( ) ) ;  <NL> markdown promotion . set promotion type ( promotion . promotion type ( ) ) ;  <NL> context ( ) . set sale mod ( markdown promotion ) ;  <NL> context ( ) . apply sale mod ( false ) ;  <NL> applied = true ;  <NL>  }  <NL>  }  COM: <s> apply amount discount promotion but only if sale modifier is not </s>