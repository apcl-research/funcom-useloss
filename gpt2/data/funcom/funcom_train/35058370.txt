TDAT: public int tally ( ) {  <NL> long current time millis = clock . current time millis ( ) ;  <NL>  <NL>  / / calculates time for which we remove any errors before <NL> final long remove times before millis = current time millis - window millis ;  <NL>  <NL> synchronized ( queue ) {  <NL>  / / drain out any expired timestamps but don ' t drain past empty <NL> while ( ! queue . is empty ( ) & & queue . peek first ( ) < remove times before millis ) {  <NL> queue . remove first ( ) ;  <NL>  }  <NL> return queue . size ( ) ;  <NL>  }  <NL>  }  COM: <s> returns a count of in window events </s>