TDAT: public coordinate to equatorial ( angle latitude ) {  <NL>  <NL> double <NL> sin phi = latitude . sin ( ) ,  <NL> cos phi = latitude . cos ( ) ,  <NL> cos a = get az angle ( ) . cos ( ) ,  <NL> sin a = get az angle ( ) . sin ( ) ;  <NL>  <NL> return new coordinate (  <NL> math . atan2 ( sin a ,  <NL> cos a * sin phi + math . tan ( get alt ( ) ) * cos phi ) ,  <NL> math . asin ( sin phi * sin dec - cos phi * cos dec * cos a ) ,  <NL> get distance ( ) ) ;  <NL>  }  COM: <s> convert a coordinate in horizon orientation to one in </s>