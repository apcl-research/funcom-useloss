TDAT: public void stop capture session ( ) {  <NL> if ( ! packet capture thread . is session in progress ( ) ) {  <NL> return ;  <NL>  }  <NL>  <NL>  / / this should automatically take care of the start and stop <NL>  / / action items .  <NL> packet capture thread thread = packet capture thread . get session ( ) ;  <NL> packet capture thread . close session ( ) ;  <NL>  <NL> if ( pcap out ! = null ) {  <NL> pcap out . close ( ) ;  <NL> pcap out = null ;  <NL>  }  <NL>  <NL>  / / analyze the packets captured so far .  <NL>  / / packet capture queue queue = thread . get queue ( ) ;  <NL>  / / queue . analyze packets ( ) ;  <NL>  <NL>  / / now open the editor with the packets .  <NL> open packet capture editor ( ) ;  <NL>  }  COM: <s> stops an ongoing capture session </s>