TDAT: public void breakloop ( uuid trace id , pcap pcap ) {  <NL> if ( lock index . contains key ( trace id ) ) {  <NL> try {  <NL> lock index . get ( trace id ) . write lock ( ) . lock ( ) ;  <NL>  <NL> logger . debug ( " trying to break pcap loop . " ) ;  <NL> if ( pcap ! = null ) {  <NL> pcap . breakloop ( ) ;  <NL>  }  <NL>  } finally {  <NL> lock index . get ( trace id ) . write lock ( ) . unlock ( ) ;  <NL>  }  <NL>  } else {  <NL> logger . error ( " lock not registered for trace : " + trace id . to string ( ) ) ;  <NL>  }  <NL>  }  COM: <s> sets a flag to indicate that the pcap loop should be terminated </s>