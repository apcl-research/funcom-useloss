TDAT: public void finish ( ) throws io exception {  <NL> ensure open ( ) ;  <NL> if ( finished ) {  <NL> return ;  <NL>  }  <NL> if ( entry ! = null ) {  <NL> close entry ( ) ;  <NL>  }  <NL> if ( entries . size ( ) < 1 ) {  <NL> throw new zip exception ( " zip file must have at least one entry " ) ;  <NL>  }  <NL>  / / write central directory <NL> long off = written ;  <NL> enumeration e = entries . elements ( ) ;  <NL> while ( e . has more elements ( ) ) {  <NL> write cen ( ( e zip entry ) e . next element ( ) ) ;  <NL>  }  <NL> write end ( off , written - off ) ;  <NL> finished = true ;  <NL>  }  COM: <s> finishes writing the contents of the zip output stream without closing </s>