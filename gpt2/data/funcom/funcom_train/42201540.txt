TDAT: public user check user credentials ( string username , string password ) {  <NL> user ret = null ;  <NL> string query =  <NL>  " select u " +  <NL>  " from user u " +  <NL>  " where username = : username and password = : password " ;  <NL> try {  <NL> query q = em . create query ( query ) ;  <NL> q . set parameter ( " username " , username ) ;  <NL> q . set parameter ( " password " , util . encode user password ( password ) ) ;  <NL>  <NL> try {  <NL> ret = ( user ) q . get single result ( ) ;  <NL>  } catch ( exception e ) { }  <NL>  } catch ( exception e ) {  <NL> log . error ( " an error occurred while checking credentials . " , e ) ;  <NL>  }  <NL> return ret ;  <NL>  }  COM: <s> checks the provided user credentials and returns the corresponding user </s>