TDAT: private int get last code line ( i document d , int line ) {  <NL> int res = line ;  <NL> try {  <NL> while ( res > - 1 ) {  <NL> i region reg = d . get line information ( res ) ;  <NL> string str = d . get ( reg . get offset ( ) , reg . get length ( ) ) . trim ( ) ;  <NL> if ( ! str . starts with ( " # " ) & & str . length ( ) > 0 )  <NL> return res ;  <NL> res - - ;  <NL>  }  <NL>  } catch ( bad location exception e ) {  <NL> e . print stack trace ( ) ;  <NL>  }  <NL> return res ;  <NL>  }  COM: <s> find line with number line that is tcl code line not comment </s>