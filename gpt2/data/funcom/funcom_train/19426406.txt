TDAT: private resource set calculate needed amount ( string res name ) {  <NL> if ( child policy ! = null ) {  <NL> needed res = child policy . calculate needed amount ( res name ) ;  <NL>  } else if ( consumer ! = null ) {  <NL> resource set total needed = consumer <NL>  . get needed resources ( ) . get restriction ( res name ) ;  <NL> resource distribution distribution <NL>  = distributing . get resource distribution ( ) ;  <NL> resource set already distributed = distribution <NL>  . get resources for consumer ( consumer )  <NL>  . get restriction ( res name ) ;  <NL> needed res = total needed . sub ( already distributed ) ;  <NL>  } else {  <NL> assert false : " not possible according to invariant " ;  <NL>  }  <NL> return needed res ;  <NL>  }  COM: <s> returns how much resources this child policy or consumer </s>