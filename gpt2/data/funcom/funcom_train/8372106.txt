TDAT: public void send request ( outgoing message message , response handler handler , int timeout ) {  <NL>  <NL> long thisrequestid ;  <NL>  <NL> synchronized ( pending ) {  <NL> thisrequestid = requestid ;  <NL>  {  <NL> if ( requestid ! = long . max _ value ) {  <NL> requestid + + ;  <NL>  } else {  <NL> requestid = long . min _ value ;  <NL>  }  <NL>  } while ( pending . contains key ( requestid ) ) ;  <NL>  }  <NL>  <NL> byte buffer buffer = byte buffer . allocate ( 1 + 8 ) ;  <NL>  <NL> buffer . put ( requestbroker _ request ) ;  <NL> buffer . put long ( thisrequestid ) ;  <NL> buffer . flip ( ) ;  <NL> message . prepend content ( buffer ) ;  <NL>  <NL> synchronized ( pending ) {  <NL> pending . put ( thisrequestid , handler ) ;  <NL>  }  <NL> msgbroker . send message ( message ) ;  <NL> reactor . add task ( new timeout handler ( thisrequestid ) , system . current time millis ( ) + timeout , false ) ;  <NL>  <NL>  }  COM: <s> sends a new request </s>