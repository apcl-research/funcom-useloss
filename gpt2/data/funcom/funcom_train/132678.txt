TDAT: public int map to reference ( int map _ pos ) {  <NL> int i ;  <NL> int ref _ pos = integer . min _ value ;  <NL> if ( map _ pos < map _ start || map _ pos > map _ end ) {  <NL> return ref _ pos ;  <NL>  }  <NL>  <NL> span sp ;  <NL> int numspans = spans . size ( ) ;  <NL> for ( i = 0 ; i < numspans ; i + + ) {  <NL> sp = spans . get ( i ) ;  <NL> if ( map _ pos > = sp . seq _ start & & map _ pos < = sp . seq _ end ) {  <NL> ref _ pos = sp . ref _ start + ( map _ pos - sp . seq _ start ) ;  <NL> return ref _ pos ;  <NL>  }  <NL>  }  <NL> return ref _ pos ;  <NL>  }  COM: <s> maps a sequence position to a reference position </s>