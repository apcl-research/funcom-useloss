TDAT: public void calculate ( string db , transaction tx ) throws exception {  <NL> if ( subquery = = null ) {  <NL> return ;  <NL>  }  <NL> plan p = planner . create query plan ( ( select ) subquery , db , tx ) ;  <NL> scan s = p . open ( ) ;  <NL> result row result = s . next ( ) ;  <NL> result schema schema = s . get schema ( ) ;  <NL> switch ( schema . get ( 0 ) . type ) {  <NL> case types . int :  <NL> case types . boolean :  <NL> final value = new integer value ( integer . parse int ( result . get ( 0 ) ) ) ;  <NL> break ;  <NL> case types . float :  <NL> final value = new float value ( float . parse float ( result . get ( 0 ) ) ) ;  <NL> break ;  <NL> default :  <NL> final value = new string value ( result . get ( 0 ) ) ;  <NL>  }  <NL>  }  COM: <s> calculate the final value of subquery </s>