TDAT: protected double psi from range ( double height , double range ) {  <NL> if ( range > get horizon distance ( height ) ) {  <NL> return - 1 ;  <NL>  }  <NL> double a = earth radius ;  <NL> double b = earth radius + height ;  <NL> double c = range ;  <NL> double cos psi = ( b * b + c * c - a * a ) / ( 2 * b * c ) ;  <NL> if ( math . abs ( cos psi ) > 1 ) {  <NL> return - 1 ;  <NL>  }  <NL> return math . acos ( cos psi ) ;  <NL>  }  COM: <s> convert a range to an angle up from the vertical </s>