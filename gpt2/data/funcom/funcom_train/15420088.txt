TDAT: public void publish ( log record record ) {  <NL> if ( ! is loggable ( record ) ) {  <NL> return ;  <NL>  }  <NL> string msg ;  <NL> try {  <NL> msg = get formatter ( ) . format ( record ) ;  <NL>  <NL>  } catch ( exception ex ) {  <NL> report error ( null , ex , error manager . format _ failure ) ;  <NL> return ;  <NL>  }  <NL>  <NL> switch ( mode ) {  <NL> case mode _ out :  <NL> out writer . write ( msg ) ;  <NL> break ;  <NL>  <NL> case mode _ err :  <NL> err writer . write ( msg ) ;  <NL> break ;  <NL>  <NL> case mode _ both :  <NL> boolean is err = record . get level ( ) . int value ( ) > level . info . int value ( ) ;  <NL> if ( is err ) {  <NL> err writer . write ( msg ) ;  <NL>  } else {  <NL> out writer . write ( msg ) ;  <NL>  }  <NL> break ;  <NL>  <NL> default :  <NL> throw new runtime exception ( " incorrect mode " + mode ) ;  <NL>  }  <NL>  }  COM: <s> publish a message to the appropriate writer </s>