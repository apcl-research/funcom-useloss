TDAT: private void replace or register ( state state ) {  <NL> final state child = state . last child ( ) ;  <NL>  <NL> if ( child . has children ( ) ) replace or register ( child ) ;  <NL>  <NL> final state registered = register . get ( child ) ;  <NL> if ( registered ! = null ) {  <NL> state . replace last child ( registered ) ;  <NL>  } else {  <NL> register . put ( child , child ) ;  <NL>  }  <NL>  }  COM: <s> replace last child of code state code with an already registered state </s>