TDAT: public void close ( boolean wait for merges ) throws corrupt index exception , io exception {  <NL>  <NL>  / / ensure that only one thread actually gets to do the closing :  <NL> if ( should close ( ) ) {  <NL>  / / if any methods have hit out of memory error , then abort <NL>  / / on close , in case the internal state of index writer <NL>  / / or documents writer is corrupt <NL> if ( hit oom )  <NL> rollback internal ( ) ;  <NL> else <NL> close internal ( wait for merges ) ;  <NL>  }  <NL>  }  COM: <s> closes the index with or without waiting for currently </s>