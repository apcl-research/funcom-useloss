TDAT: private void add roles xml ( string buffer data , hashtable roles tree ) {  <NL>  <NL> data . append ( " < roles > " ) ;  <NL> iterator it = roles tree . values ( ) . iterator ( ) ;  <NL>  <NL> while ( it . has next ( ) ) {  <NL> role role = ( role ) it . next ( ) ;  <NL>  <NL>  / / we are only interested in top level roles <NL>  / / as object refs handle subroles .  <NL>  / / this should be refactored .  <NL> if ( role . is top level ( ) ) {  <NL> add role xml ( data , role ) ;  <NL>  }  <NL>  }  <NL>  <NL> data . append ( " < / roles > " ) ;  <NL>  }  COM: <s> adds the roles xml </s>