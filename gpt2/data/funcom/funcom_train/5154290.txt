TDAT: public long rank sum ( ) {  <NL> if ( rank sum > = 0 ) return rank sum ;  <NL> rank sum = 0 ;  <NL> ranked genes count = 0 ;  <NL> max rank = 0 ;  <NL> for ( string gene : get interesting genes ( ) ) {  <NL> int r = gene sets . get rank ( gene ) ;  <NL> if ( r > 0 ) {  <NL> ranked genes count + + ;  <NL> rank sum + = r ;  <NL>  } else throw new runtime exception ( " this should never happen ! ! ! ranked symbol " + gene + " has rank = 0 " ) ;  <NL>  <NL> if ( max rank < r ) max rank = r ;  <NL>  }  <NL>  <NL> return rank sum ;  <NL>  }  COM: <s> calculate rank sum ranked symbols and max rank </s>