TDAT: public void on closed ( ) {  <NL> if ( m state ! = state . state _ connected ) return ;  <NL>  <NL> m close when done xmit = true ;  <NL> if ( m out buffer . position ( ) = = 0 ) {  <NL> if ( vpn nat engine . s log ) log . v ( " azi link " , " nio : : on closed is closing immediately since no buffer " ) ;  <NL> m state = state . state _ none ;  <NL> m tcp . close ( ) ;  <NL>  } else {  <NL> if ( vpn nat engine . s log ) log . v ( " azi link " , " nio : : on closed is pending " ) ;  <NL>  }  <NL>  }  COM: <s> tcp driver received end of stream </s>