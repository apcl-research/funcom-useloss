TDAT: public quantity buy up to quantity ( position position , probability target probability , quantity max quantity , user user ) {  <NL> quantity quantity for full probability movement = total c ( position , target probability ) ;  <NL> probability prob = target probability ;  <NL> if ( quantity for full probability movement . compare to ( max quantity ) > 0 ) {  <NL> prob = prob limit ( position , target probability , max quantity ) ;  <NL>  }  <NL> return purchase ( position , prob , user ) ;  <NL>  }  COM: <s> buy from the market maker to make the probability reach targetprobability </s>