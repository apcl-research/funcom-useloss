TDAT: public string get string ref ( ) {  <NL> if ( ( this . getvt ( ) & variant type mask ) = = variant string <NL>  & & ( this . getvt ( ) & variant byref ) = = variant byref ) {  <NL> return get variant string ref ( ) ;  <NL>  } else {  <NL> throw new illegal state exception (  <NL>  " get string ref ( ) only legal on by ref variants of type variant string , not "  <NL>  + this . getvt ( ) ) ;  <NL>  }  <NL>  }  COM: <s> gets the content of the variant as a string ref </s>