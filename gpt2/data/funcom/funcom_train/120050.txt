TDAT: public map diff map ( map old state , map new state ) {  <NL> map diff = new hashtable ( ) ;  <NL> iterator it = new state . entry set ( ) . iterator ( ) ;  <NL> while ( it . has next ( ) ) {  <NL> map . entry entry = ( map . entry ) it . next ( ) ;  <NL> object key = entry . get key ( ) ;  <NL> object new value = entry . get value ( ) ;  <NL> object old value = old state . get ( key ) ;  <NL> if ( old value = = null || ! old value . equals ( new value ) )  <NL> diff . put ( key , new value ) ;  <NL>  }  <NL> return diff ;  <NL>  }  COM: <s> returns a new map that contains all key value pairs </s>