TDAT: public boolean semantic event before ( semantic event se , string msg ) {  <NL> if ( super . semantic event before ( se , msg ) ) return true ;  <NL> else if ( document . msg _ close = = msg ) {  <NL>  / / periodically write history in case of crash <NL> if ( periodcnt _ + + > period ) { write history ( ) ; periodcnt _ = 0 ; }  <NL>  <NL>  } else if ( multivalent . msg _ exit = = msg || browser . msg _ close = = msg ) {  <NL> write history ( ) ;  <NL>  }  <NL> return false ;  <NL>  }  COM: <s> write out history at exit exit browser instance and every so many </s>