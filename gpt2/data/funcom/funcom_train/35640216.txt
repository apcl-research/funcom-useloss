TDAT: public void add document ( document doc , analyzer analyzer ) throws corrupt index exception , io exception {  <NL> ensure open ( ) ;  <NL> segment info new segment info = build single doc segment ( doc , analyzer ) ;  <NL> synchronized ( this ) {  <NL> ram segment infos . add element ( new segment info ) ;  <NL> maybe flush ram segments ( ) ;  <NL>  }  <NL>  }  COM: <s> adds a document to this index using the provided analyzer instead of the </s>