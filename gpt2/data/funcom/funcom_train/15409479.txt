TDAT: public database platform create ( server config server config ) {  <NL>  <NL> try {  <NL>  <NL> if ( server config . get database platform name ( ) ! = null ) {  <NL>  / / choose based on db name <NL> return by database name ( server config . get database platform name ( ) ) ;  <NL>  <NL>  }  <NL> if ( server config . get data source config ( ) . is offline ( ) ) {  <NL> string m = " you must specify a database platform name when you are offline " ;  <NL> throw new persistence exception ( m ) ;  <NL>  }  <NL>  / / guess using meta data from driver <NL> return by data source ( server config . get data source ( ) ) ;  <NL>  <NL>  <NL>  } catch ( exception ex ) {  <NL> throw new persistence exception ( ex ) ;  <NL>  }  <NL>  }  COM: <s> create the appropriate database specific platform </s>