TDAT: public void do identify customer ( long customer id ) {  <NL> if ( click stream page event fact = = null ) {  <NL> throw new illegal state exception ( " this method can only be called after the first call to log page hit . " ) ;  <NL>  }  <NL>  <NL> click stream page event fact . set customer key ( customer id ) ;  <NL> entity manager . merge ( click stream page event fact ) ;  <NL> entity manager . flush ( ) ; / / we do real time web analytics , this session needs to be available to update models for new users .  <NL>  }  COM: <s> when this is called the customer for this business has been identified </s>