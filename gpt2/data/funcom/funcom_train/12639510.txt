TDAT: public permission collection get permissions ( protection domain domain ) {  <NL> permissions perms = new permissions ( ) ;  <NL>  <NL> if ( domain = = null )  <NL> return perms ;  <NL>  <NL>  / / first get policy perms <NL> get permissions ( perms , domain ) ;  <NL>  <NL>  / / add static perms <NL>  / / - adding static perms after policy perms is necessary <NL>  / / to avoid a regression for 4301064 <NL> permission collection pc = domain . get permissions ( ) ;  <NL> if ( pc ! = null ) {  <NL> enumeration e = pc . elements ( ) ;  <NL> while ( e . has more elements ( ) ) {  <NL> perms . add ( ( permission ) e . next element ( ) ) ;  <NL>  }  <NL>  }  <NL>  <NL> return perms ;  <NL>  }  COM: <s> examines this code policy code and returns the permissions granted </s>