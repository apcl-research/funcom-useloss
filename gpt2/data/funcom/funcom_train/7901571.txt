TDAT: protected query apply filters ( query query ) {  <NL> if ( table . get filters ( ) . is empty ( ) ) {  <NL> return query ;  <NL>  }  <NL> query q = query . copy ( ) ;  <NL> for ( map . entry < string , filter > e : table . get filters ( ) . entry set ( ) ) {  <NL> string k = e . get key ( ) ;  <NL> filter f = e . get value ( ) ;  <NL> map < string , filter extension > extensions = table . get filter extensions ( ) . get ( k ) ;  <NL> q . where ( f . as expression ( extensions ) ) ;  <NL>  }  <NL> return q ;  <NL>  }  COM: <s> todo this uses a cast to use the non public copy method </s>