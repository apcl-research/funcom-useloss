TDAT: public double calculate likelihood ( mutable tree tree , string [ ] attributes , contrastable [ ] mles , double kappa ) {  <NL>  <NL> contrasted trait node contrast node = new contrasted trait node ( tree , tree . get root ( ) , attributes ) ;  <NL> contrast node . calculate contrasts ( kappa ) ;  <NL>  <NL> for ( int i = 0 ; i < mles . length ; i + + ) {  <NL> mles [ i ] = contrast node . get trait value ( i ) ;  <NL>  }  <NL>  <NL> return calculate traits likelihood ( contrast node ) ;  <NL>  }  COM: <s> calculates the likelihood of the traits on the given tree </s>