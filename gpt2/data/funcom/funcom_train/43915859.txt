TDAT: public void write to ( output stream out ) throws io exception , service exception {  <NL>  / / gr : shall we add a palette parameter to get legend graphic too ?  <NL> final buffered image legend graphic = get legend graphic ( ) ;  <NL> rendered image forced indexed8bitmask = image utils . force indexed8bitmask ( legend graphic , null ) ;  <NL> image worker image worker = new image worker ( forced indexed8bitmask ) ;  <NL> image worker . write gif ( out , " lzw " , 0 . 75f ) ;  <NL>  }  COM: <s> encodes on the fly the image generated on </s>