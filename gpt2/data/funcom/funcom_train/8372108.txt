TDAT: public void send message ( outgoing message message ) {  <NL> byte [ ] sign = null ;  <NL> byte buffer signbuf ;  <NL>  <NL> try {  <NL> synchronized ( signer ) {  <NL> iterator < byte buffer > iterator = message . get payload ( ) . iterator ( ) ;  <NL> while ( iterator . has next ( ) ) {  <NL> byte buffer buffer = iterator . next ( ) ;  <NL> buffer . mark ( ) ;  <NL>  <NL> signer . update ( buffer ) ;  <NL>  <NL> buffer . reset ( ) ;  <NL>  }  <NL> sign = signer . sign ( ) ;  <NL>  }  <NL>  <NL> signbuf = byte buffer . allocate ( sign . length + 4 ) ;  <NL> signbuf . put int ( sign . length ) ;  <NL> signbuf . put ( sign ) ;  <NL> signbuf . flip ( ) ;  <NL> message . prepend content ( signbuf ) ;  <NL> pubkey . reset ( ) ;  <NL> message . prepend content ( pubkey ) ;  <NL>  <NL> broker . send message ( message ) ;  <NL>  } catch ( signature exception e ) {  <NL> assert ( false ) ;  <NL>  }  <NL>  }  COM: <s> sends a signed message </s>