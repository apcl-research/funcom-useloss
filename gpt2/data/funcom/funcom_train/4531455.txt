TDAT: private int merge pass ( path tmp dir ) throws io exception {  <NL> log . debug ( " running merge pass " ) ;  <NL> writer writer = clone file attributes (  <NL> out file . suffix ( " . 0 " ) , out file , null ) ;  <NL> raw key value iterator r = merge ( out file . suffix ( " . 0 " ) ,  <NL> out file . suffix ( " . 0 . index " ) , tmp dir ) ;  <NL> write file ( r , writer ) ;  <NL>  <NL> writer . close ( ) ;  <NL> return 0 ;  <NL>  }  COM: <s> sort calls this to generate the final merged output </s>