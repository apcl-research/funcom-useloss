TDAT: public void finish ( ) throws io exception {  <NL> close entry ( ) ;  <NL> cd offset = written ;  <NL> for ( int i = 0 , entries size = entries . size ( ) ; i < entries size ; i + + ) {  <NL> write central file header ( ( zip entry ) entries . element at ( i ) ) ;  <NL>  }  <NL> cd length = written - cd offset ;  <NL> write central directory end ( ) ;  <NL> offsets . clear ( ) ;  <NL> entries . remove all elements ( ) ;  <NL>  }  COM: <s> finishs writing the contents and closes this as well as the </s>