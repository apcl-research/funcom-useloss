TDAT: {  <NL> int intensity = v . intvalue ;  <NL> int index = v . index ;  <NL>  / / code magnitude into bits .  <NL> int igradient = ( int ) ( g . getmag ( ) * fraction magnitude ) & mask magnitude ;  <NL>  / / make all of it fit into 16 bits .  <NL> int entry = ( igradient < < nr intensity bits ) | intensity ;  <NL> return new vj alpha color ( opacity table [ entry ] , 255 ) ;  <NL>  }  COM: <s> classify the interpolated voxel value and gradient magnitude </s>