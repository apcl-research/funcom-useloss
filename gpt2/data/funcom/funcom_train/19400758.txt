TDAT: protected void prepared ( i tx tx ) throws illegal state exception {  <NL>  <NL> long id = tx . get start timestamp ( ) ;  <NL>  <NL> i tx tx2 = active tx . remove ( id ) ;  <NL>  <NL> if ( tx2 = = null )  <NL> throw new illegal state exception ( " not active : tx = " + tx ) ;  <NL>  <NL> assert tx = = tx2 ;  <NL>  <NL> if ( prepared tx . contains key ( id ) )  <NL> throw new illegal state exception ( " already preparing : tx = " + tx ) ;  <NL>  <NL> prepared tx . put ( id , tx ) ;  <NL>  <NL>  }  COM: <s> notify the journal that a transaction has prepared and hence is no </s>