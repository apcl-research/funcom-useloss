TDAT: private entity end until entity ( int type ) {  <NL> for ( iterator it = entity stack . iterator ( ) ; it . has next ( ) ; ) {  <NL> entity e = ( entity ) it . next ( ) ;  <NL> if ( ! e . head written ) {  <NL> e . write head ( out , get last container entity ( ) ) ;  <NL>  }  <NL> e . write foot ( out , get last container entity ( ) ) ;  <NL> it . remove ( ) ;  <NL> if ( type = = e . type ) {  <NL> return e ;  <NL>  }  <NL>  }  <NL> return null ;  <NL>  }  COM: <s> end entities until one of the specified type has been found </s>