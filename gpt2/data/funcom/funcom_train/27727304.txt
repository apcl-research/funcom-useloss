TDAT: public boolean visible ( vector n losu , vector n r , vector n r iss ) {  <NL>  <NL>  / / check elevation mask <NL> boolean visible = true ;  <NL>  <NL>  / / check iss visibility <NL> double dist = r . mag ( ) ;  <NL> double cone = math . atan2 ( earth radius , dist ) ;  <NL> vector n r _ unit = r . unit vector ( ) . times ( - 1 . 0 ) ;  <NL> double cos _ delta = r _ unit . dot product ( losu ) ;  <NL> double delta = math . acos ( cos _ delta ) ;  <NL> if ( delta < cone ) {  <NL> visible = false ;  <NL>  }  <NL>  <NL> return visible ;  <NL>  }  COM: <s> determine if the gps satellite is visible including earth blockage </s>