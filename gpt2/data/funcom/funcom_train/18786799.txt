TDAT: protected file get directory ( ) {  <NL> file directory = null ;  <NL> if ( selected file ! = null ) {  <NL> directory = selected file . get parent file ( ) ;  <NL>  } else {  <NL> explorer document document = get explorer ( ) . get document ( ) ;  <NL> if ( document ! = null ) {  <NL> file file = document . get file ( ) ;  <NL> if ( file ! = null ) {  <NL> directory = file . get parent file ( ) ;  <NL>  }  <NL>  }  <NL>  }  <NL> return directory ;  <NL>  }  COM: <s> returns the directory from which the file should be first searched </s>