TDAT: public int send get challenge and store ( boolean use sm ) throws card service exception {  <NL> command apdu capdu = create get challenge apdu ( ) ;  <NL> if ( use sm ) {  <NL> capdu = get wrapper ( ) . wrap ( capdu ) ;  <NL>  }  <NL> response apdu rapdu = transmit ( capdu ) ;  <NL> if ( use sm ) {  <NL> rapdu = get wrapper ( ) . unwrap ( rapdu , rapdu . get bytes ( ) . length ) ;  <NL>  }  <NL> if ( rapdu . get sw ( ) = = 0x9000 ) {  <NL> last challenge = rapdu . get data ( ) ;  <NL>  }  <NL> return rapdu . get sw ( ) ;  <NL>  }  COM: <s> send a get challenge the challenge received will be stored and used </s>