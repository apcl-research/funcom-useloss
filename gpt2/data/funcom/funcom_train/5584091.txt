TDAT: public void decrypt ( stream block reader input , stream block writer output , key key , mode mode ) throws exception {  <NL> this . calc key parts ( ( single key ) key ) ;  <NL> triple des mode tdesmode = ( triple des mode ) mode ;  <NL> block cryptblock = new block ( 0 ) ;  <NL> block plainblock = new block ( 0 ) ;  <NL> block lastblock = new block ( 0 ) ;  <NL>  <NL> while ( true ) {  <NL> cryptblock = input . read ( 64 ) ;  <NL>  <NL> if ( cryptblock . get length ( ) = = 0 )  <NL> break ;  <NL> else <NL> output . write ( lastblock ) ;  <NL>  <NL> plainblock = tdesmode . decrypt block ( cryptblock ) ;  <NL> lastblock = plainblock ;  <NL>  }  <NL> plainblock = tdesmode . decrypt padding ( lastblock ) ;  <NL> output . write ( plainblock ) ;  <NL>  }  COM: <s> decrypt a inputstream to an outputstream using a key with a special mode </s>