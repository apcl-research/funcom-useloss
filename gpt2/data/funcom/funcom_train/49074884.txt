TDAT: private string hmac ( final string string to sign ) {  <NL> string signature = null ;  <NL> byte [ ] data ;  <NL> byte [ ] raw hmac ;  <NL> try {  <NL> data = string to sign . get bytes ( utf8 _ charset ) ;  <NL> raw hmac = this . mac . do final ( data ) ;  <NL> final base64 encoder = new base64 ( 0 ) ;  <NL> signature = new string ( encoder . encode ( raw hmac ) ) ;  <NL>  } catch ( final unsupported encoding exception e ) {  <NL> throw new runtime exception ( utf8 _ charset + " is unsupported ! " , e ) ;  <NL>  }  <NL> return signature ;  <NL>  }  COM: <s> compute the hmac </s>