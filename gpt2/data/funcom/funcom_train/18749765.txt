TDAT: public aspectual rule view add rule ( aspectual rule view rule view ) throws illegal state exception {  <NL> aspectual rule view result = remove rule ( rule view . get name label ( ) ) ;  <NL> rule map . put ( rule view . get name label ( ) , rule view ) ;  <NL> int priority = rule view . get priority ( ) ;  <NL> set < aspectual rule view > priority rules = priority map . get ( priority ) ;  <NL> if ( priority rules = = null ) {  <NL> priority map . put ( priority , priority rules = new tree set < aspectual rule view > ( ) ) ;  <NL>  }  <NL> priority rules . add ( rule view ) ;  <NL> invalidate grammar ( ) ;  <NL> return result ;  <NL>  }  COM: <s> adds a rule based on a given rule view </s>