TDAT: public boolean check permission ( string service cap , string action ) {  <NL>  <NL>  / / get map of permissions for the service <NL> object obj = permissions . get ( service cap ) ;  <NL> if ( obj = = null || ! ( obj instanceof hash map ) )  <NL> return false ;  <NL>  <NL>  / / get permission <NL> object obj2 = ( ( hash map ) obj ) . get ( action ) ;  <NL> if ( obj2 = = null || ! ( obj2 instanceof string ) )  <NL> return false ;  <NL>  <NL>  / / check if action is allowed <NL> if ( ( ( string ) obj2 ) . equals ( " allow " ) )  <NL> return true ;  <NL> return false ;  <NL>  }  COM: <s> check for a service permission </s>