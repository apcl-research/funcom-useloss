TDAT: public string register ( string email , string password ) throws validation failed exception , user exception {  <NL> user db user = user service . get by username ( email ) ;  <NL>  <NL> if ( db user ! = null ) {  <NL> throw new user exception ( get message ( " validation . security . credentials . duplicate " ) ) ;  <NL>  }  <NL>  <NL> user user = new user ( email , password ) ;  <NL> user service . save ( user ) ;  <NL>  <NL> return request token ( email , password ) ;  <NL>  }  COM: <s> registers a new user within the portal and authenticate directly after the request </s>