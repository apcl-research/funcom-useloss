TDAT: final private void sign ( private key key ) {  <NL> if ( key = = null ) {  <NL>  <NL>  / / unknown user <NL> system . err . println ( " sharedsecret . sign ( ) : null private key " ) ;  <NL> return ;  <NL>  }  <NL> try {  <NL>  _ mdigest . reset ( ) ;  <NL>  _ mdigest . update ( secret ( ) ) ;  <NL>  _ sign . init sign ( key ) ;  <NL>  _ sign . update ( _ mdigest . digest ( ) ) ;  <NL> set signature ( _ sign . sign ( ) ) ;  <NL>  } catch ( invalid key exception excpt ) {  <NL> system . err . println ( excpt . to string ( ) ) ;  <NL> return ;  <NL>  } catch ( signature exception excpt ) {  <NL> system . err . println ( excpt . to string ( ) ) ;  <NL> return ;  <NL>  }  <NL>  }  COM: <s> signs the signature </s>