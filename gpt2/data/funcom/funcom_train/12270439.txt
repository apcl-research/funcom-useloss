TDAT: public int infer ( boolean strip _ species _ tree ) throws exception {  <NL>  <NL> set duplications to zero ( ) ;  <NL>  <NL> if ( strip _ species _ tree ) {  <NL> strip tree ( get gene tree ( ) , get species tree ( ) ) ;  <NL>  }  <NL>  <NL> get species tree ( ) . preorder re id ( 0 ) ;  <NL>  <NL> link ext nodes of g ( ) ;  <NL>  <NL> gene tree post order traversal ( get gene tree ( ) . get root ( ) ) ;  <NL>  <NL> return get duplications ( ) ;  <NL>  <NL>  } / / infer ( boolean )  COM: <s> infers for each node of gene tree set in constructor whether it </s>