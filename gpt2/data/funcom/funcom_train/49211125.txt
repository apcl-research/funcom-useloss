TDAT: public sparse matrix run ( sparse matrix a , double max residual , double p gamma , double loop gain , double max zero ) {  <NL>  <NL>  / / add cycles <NL> add loops ( a , loop gain ) ;  <NL>  / / make stochastic <NL> a . normalise rows ( ) ;  <NL>  <NL> double residual = 1 . ;  <NL> int i = 0 ;  <NL>  <NL>  / / main iteration <NL> while ( residual > max residual ) {  <NL> i + + ;  <NL> a = expand ( a ) ;  <NL> residual = inflate ( a , p gamma , max zero ) ;  <NL>  }  <NL> return a ;  <NL>  }  COM: <s> run the mcl process </s>