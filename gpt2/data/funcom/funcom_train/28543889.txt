TDAT: public boolean self test ( ) {  <NL> int n i ;  <NL> sha1 tester ;  <NL> byte [ ] digest ;  <NL>  <NL> tester = new sha1 ( ) ;  <NL>  <NL> tester . update ( selftest _ message ) ;  <NL> tester . finalize ( ) ;  <NL>  <NL> digest = tester . get digest ( ) ;  <NL>  <NL> for ( n i = 0 ; n i < digest _ size ; n i + + ) {  <NL> if ( digest [ n i ] ! = selftest _ digest [ n i ] ) {  <NL> return false ;  <NL>  }  <NL>  }  <NL> return true ;  <NL>  }  COM: <s> runs an integrity test </s>