TDAT: protected void output character reference ( int charval ) throws java . io . io exception {  <NL> int len = 0 ;  <NL> charref [ len + + ] = ' & ' ;  <NL> charref [ len + + ] = ' # ' ;  <NL> if ( prefer hex ) charref [ len + + ] = ' x ' ;  <NL> string code = prefer hex <NL>  ? integer . to hex string ( charval )  <NL>  : integer . to string ( charval ) ;  <NL> int codelen = code . length ( ) ;  <NL> for ( int k = 0 ; k < codelen ; k + + ) {  <NL> charref [ len + + ] = code . char at ( k ) ;  <NL>  }  <NL> charref [ len + + ] = ' ; ' ;  <NL> writer . write ( charref , 0 , len ) ;  <NL> line pos + = len ;  <NL>  }  COM: <s> write charval to output as character reference e </s>