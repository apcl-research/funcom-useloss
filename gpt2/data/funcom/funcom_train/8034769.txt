TDAT: public int send ( string msg body , int serial number ) throws socket exception {  <NL> boolean reconnect = true ;  <NL> string data = null ;  <NL>  <NL> if ( serial number < 0 ) {  <NL> serial number = this . serial number ;  <NL> this . serial number + = 1 ;  <NL> if ( this . serial number = = integer . max _ value )  <NL> this . serial number = 1 ;  <NL>  }  <NL>  <NL> msg . set body ( msg body ) ;  <NL> msg . set serial number ( serial number ) ;  <NL> data = msg . build msg buf ( ) ;  <NL>  <NL> while ( reconnect ) {  <NL> try {  <NL>  <NL> socket output writer . write ( data ) ;  <NL> socket output writer . flush ( ) ;  <NL> reconnect = false ;  <NL>  } catch ( io exception ioe ) {  <NL> reconnect ( ) ;  <NL>  }  <NL>  }  <NL> return serial number ;  <NL>  }  COM: <s> send message through socket and reconnect when it is necessary </s>