TDAT: public void create message authentication ( message message ) {  <NL> try {  <NL> log . info ( message . to string without mac ( ) ) ;  <NL> message . set mac ( security service . create mac ( message . get bytes without mac ( ) , routing session key ) ) ;  <NL>  } catch ( security service exception sse ) {  <NL> log . error ( " couldn ' t create and append mac for message . " ) ;  <NL>  <NL> process error ( message , new error type ( error type . authentication _ not _ available ,  <NL>  " couldn ' t create a mac for this message and attach it . " ) ) ;  <NL>  <NL>  }  <NL>  }  COM: <s> creates a message authentication code for the provided message </s>