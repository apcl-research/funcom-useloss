TDAT: public session get session ( ) {  <NL> hibernate thread local local value =  <NL> m _ thread local . get ( ) ;  <NL> if ( local value = = null ) {  <NL> throw new illegal state exception (  <NL>  " you are not currently inside a hibernate transaction . " ) ;  <NL>  }  <NL>  <NL> if ( local value . m _ session = = null ) {  <NL> local value . m _ session = get session factory ( ) . open session ( ) ;  <NL> local value . m _ transaction = local value . m _ session . begin transaction ( ) ;  <NL>  }  <NL>  <NL> return local value . m _ session ;  <NL>  }  COM: <s> returns the current session </s>