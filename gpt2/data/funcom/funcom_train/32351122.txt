TDAT: public mode active mode ( ) {  <NL> mode active = ( mode ) get state ( ) . get ( state key ( true ) + active _ mode ) ;  <NL> if ( active = = null ) {  <NL> if ( this . default mode = = null )  <NL> throw new illegal state exception ( " no modes found : at least one " +  <NL>  " is required " ) ;  <NL> active = this . default mode ;  <NL> active . set active ( true ) ;  <NL> get state ( ) . put ( state key ( true ) + active _ mode , active ) ;  <NL>  }  <NL> return active ;  <NL>  }  COM: <s> returns the currently active mode </s>