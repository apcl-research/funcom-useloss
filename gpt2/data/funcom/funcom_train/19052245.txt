TDAT: private float gain ( float f , float gain ) {  <NL> float p = ( float ) math . log ( 1 . 0 - gain ) / ( float ) math . log ( 0 . 5 ) ;  <NL>  <NL> if ( f < . 001 )  <NL> return 0 . 0f ;  <NL> else if ( f > . 999 )  <NL> return 1 . 0f ;  <NL> if ( f < 0 . 5 )  <NL> return ( float ) math . pow ( 2 * f , p ) / 2 ;  <NL> else <NL> return 1 . 0f - ( float ) math . pow ( 2 * ( 1 . - f ) , p ) / 2 ;  <NL>  }  COM: <s> calculate gain value for pixel value value in 0 1 range </s>