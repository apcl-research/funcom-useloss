TDAT: public void finish document ( ) throws object format exception {  <NL> for ( int i = 0 , len = nesting levels . size ( ) ; i < len ; i + + ) {  <NL>  _ close last element ( ) ;  <NL>  }  <NL>  <NL> try {  <NL> out . flush ( ) ;  <NL>  }  <NL> catch ( io exception ex ) {  <NL> throw new object format exception ( ex ) ;  <NL>  }  <NL>  }  COM: <s> close all open elements and write them to the sink </s>