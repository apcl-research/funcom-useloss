TDAT: private short get color index ( color swt color ) {  <NL> if ( ! color index . contains ( swt color ) ) {  <NL> color index . add ( swt color ) ;  <NL>  <NL> hssf palette palette = ( ( hssf workbook ) xl workbook ) . get custom palette ( ) ;  <NL>  <NL> palette . set color at index ( ( short ) ( 55 - color index . index of ( swt color ) ) ,  <NL>  ( byte ) swt color . get red ( ) ,  <NL>  ( byte ) swt color . get green ( ) ,  <NL>  ( byte ) swt color . get blue ( )  <NL>  ) ;  <NL>  }  <NL>  <NL> return ( short ) ( 55 - color index . index of ( swt color ) ) ;  <NL>  }  COM: <s> note the excel hssf format only supports a maximum of 56 custom colors </s>