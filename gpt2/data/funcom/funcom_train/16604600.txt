TDAT: public void update morph time ( float delta ) {  <NL> offset + = delta ;  <NL> if ( offset < 0 ) {  <NL> int index = shapes . index of ( current ) ;  <NL> if ( index < 0 ) {  <NL> index = shapes . size ( ) - 1 ;  <NL>  }  <NL>  <NL> int nframe = rational ( index + 1 ) ;  <NL> set frame ( index , nframe , offset ) ;  <NL> offset + = 1 ;  <NL>  } else if ( offset > 1 ) {  <NL> int index = shapes . index of ( next ) ;  <NL> if ( index < 1 ) {  <NL> index = 0 ;  <NL>  }  <NL>  <NL> int nframe = rational ( index + 1 ) ;  <NL> set frame ( index , nframe , offset ) ;  <NL> offset - = 1 ;  <NL>  } else {  <NL> points dirty = true ;  <NL>  }  <NL>  }  COM: <s> update the morph time and hence the curent frame </s>