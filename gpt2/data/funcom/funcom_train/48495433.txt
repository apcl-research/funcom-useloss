TDAT: public int find x ( double x ) {  <NL> x - = x min ;  <NL> x * = inv x step ;  <NL>  <NL>  / / todo : torus <NL> int xx = ( int ) math . floor ( x ) ;  <NL>  / / while ( xx < 0 ) xx + = x size ;  <NL>  / / while ( xx > = x size ) xx - = x size ;  <NL>  <NL> if ( xx < 0 )  <NL> xx = 0 ;  <NL> else if ( xx > = x size )  <NL> xx = x size - 1 ;  <NL>  <NL> return xx ;  <NL>  }  COM: <s> returns the grid x coordinate corresponding to the space x coordinate </s>