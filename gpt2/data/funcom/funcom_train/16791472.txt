TDAT: protected void wait for end ( transaction < ? > transaction , boolean forever ) throws exception {  <NL> int count = forever ? integer . max _ value : 2000 ;  <NL>  <NL> while ( ! transaction . is idle ( ) & & ! transaction . is stopped ( ) & & ! transaction . is error ( ) & & count > 0 ) {  <NL> thread . sleep ( 100 ) ;  <NL> count - = 100 ;  <NL>  }  <NL>  }  COM: <s> wait for a transaction to creak to a halt </s>