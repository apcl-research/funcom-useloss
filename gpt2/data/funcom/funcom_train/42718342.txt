TDAT: public object wait until finish ( long timeout ) throws throwable {  <NL> long kill time = - 1 ;  <NL> if ( timeout > 0 )  <NL> kill time = system . current time millis ( ) + timeout ;  <NL> do {  <NL> try {  <NL> thread . sleep ( 50 ) ;  <NL>  }  <NL> catch ( interrupted exception e ) {  <NL>  }  <NL>  }  <NL> while ( ! has completed & & ( ( kill time > 0 & & system . current time millis ( ) < kill time ) || kill time < = 0 ) ) ;  <NL> if ( ! has completed )  <NL> throw new javax . naming . time limit exceeded exception ( ) ;  <NL> if ( null ! = thrown exception )  <NL> throw thrown exception ;  <NL> else <NL> return return value ;  <NL>  }  COM: <s> wait until the transaction completes and return the value returned </s>