TDAT: private boolean is allowed ( user current user , string request uri ) {  <NL> if ( current user = = null ) {  <NL> return false ;  <NL>  }  <NL> if ( user service . is user admin ( ) ) {  <NL> return true ;  <NL>  }  <NL> if ( is admin only ( request uri ) ) {  <NL> return false ;  <NL>  }  <NL> persistence manager persistence manager = pmf . get ( )  <NL>  . get persistence manager ( ) ;  <NL> try {  <NL> user profile dao dao = new user profile dao impl ( persistence manager ) ;  <NL> user profile user for email = dao . get user for email ( current user <NL>  . get email ( ) ) ;  <NL> if ( user for email = = null ) {  <NL> return false ;  <NL>  } else {  <NL> return true ;  <NL>  }  <NL>  } finally {  <NL> persistence manager . close ( ) ;  <NL>  }  <NL>  }  COM: <s> checks whether this user should be able to access this uri currently </s>