TDAT: public int map to mapped ( int ref _ pos ) {  <NL> int seqpos = integer . min _ value ;  <NL> if ( ref _ pos < ref _ start || ref _ pos > ref _ end ) {  <NL> return seqpos ;  <NL>  }  <NL> int i ;  <NL> span sp ;  <NL> int numspans = spans . size ( ) ;  <NL> for ( i = 0 ; i < numspans ; i + + ) {  <NL> sp = spans . get ( i ) ;  <NL> if ( ref _ pos > = sp . ref _ start & & ref _ pos < = sp . ref _ end ) {  <NL> seqpos = sp . seq _ start + ( ref _ pos - sp . ref _ start ) ;  <NL> return seqpos ;  <NL>  }  <NL>  }  <NL> return seqpos ;  <NL>  }  COM: <s> maps a reference position to a mapped position </s>