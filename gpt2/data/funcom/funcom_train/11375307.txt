TDAT: private void finalize namenode ( name node nn , configuration conf ) throws exception {  <NL> if ( nn = = null ) {  <NL> throw new illegal state exception ( " attempting to finalize "  <NL>  + " namenode but it is not running " ) ;  <NL>  }  <NL> tool runner . run ( new dfs admin ( conf ) , new string [ ] { " - finalize upgrade " } ) ;  <NL>  }  COM: <s> finalize the namenode </s>