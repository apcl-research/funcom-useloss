TDAT: private void assign backup ( final node impl node , final node impl backup ) {  <NL> try {  <NL> transaction scheduler . run task (  <NL> new abstract kernel runnable ( " set node failed " ) {  <NL> public void run ( ) {  <NL> node . set failed ( data service , backup ) ;  <NL> if ( backup ! = null ) {  <NL> backup . add primary ( data service , node . get id ( ) ) ;  <NL>  }  <NL>  } } , task owner ) ;  <NL>  } catch ( exception e ) {  <NL> logger . log throw (  <NL> level . severe , e ,  <NL>  " marking node : { 0 } failed and assigning backup throws " ,  <NL> node ) ;  <NL>  }  <NL>  }  COM: <s> persists node and backup status updates in data service </s>