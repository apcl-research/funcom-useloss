TDAT: public void update rating ( ) {  <NL>  <NL> if ( this . ratings = = null || this . ratings . size ( ) = = 0 ) {  <NL> this . rating = 0 . 0d ;  <NL> return ;  <NL>  }  <NL>  <NL> persistence manager pm = pmf . get ( ) . get persistence manager ( ) ;  <NL>  <NL> try {  <NL>  / / loop through ratings <NL> double avg = 0 ;  <NL> for ( string k : ratings ) {  <NL> rating r = pm . get object by id ( rating . class , k ) ;  <NL> avg + = r . get rating ( ) ;  <NL>  }  <NL>  <NL> avg = avg / ratings . size ( ) ;  <NL>  <NL> this . rating = avg ;  <NL>  <NL>  } finally {  <NL> pm . close ( ) ;  <NL>  }  <NL>  <NL>  }  COM: <s> updates the local average rating by polling all of the rating objects </s>