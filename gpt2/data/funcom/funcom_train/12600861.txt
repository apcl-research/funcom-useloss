TDAT: public void services discovered ( int trans id , service record [ ] service record ) {  <NL> current state = " service gefunden " ;  <NL> for ( int i = 0 ; i < service record . length ; i + + ) {  <NL> service record record = service record [ i ] ;  <NL> try {  <NL> string name = record . get host device ( ) . get friendly name ( true ) ;  <NL> string url = record . get connection url ( service record . noauthenticate _ noencrypt , false ) ;  <NL> names . add element ( name ) ;  <NL> urls . add element ( url ) ;  <NL>  }  <NL> catch ( exception e ) {  <NL> current state = e . to string ( ) ;  <NL>  }  <NL>  }  <NL>  }  COM: <s> called by the agent when a service was discovered on the scanned device </s>