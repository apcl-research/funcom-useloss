TDAT: public ui document get current document ( ) {  <NL> ui internal frame internal frame =  <NL>  ( ui internal frame ) desktop . get selected frame ( ) ;  <NL> if ( internal frame = = null ) {  <NL> j internal frame [ ] frames = desktop . get all frames ( ) ;  <NL> if ( frames . length > 0 ) {  <NL> try {  <NL> frames [ 0 ] . set selected ( true ) ;  <NL> internal frame = ( ui internal frame ) frames [ 0 ] ;  <NL>  } catch ( property veto exception e ) {  <NL> return null ;  <NL>  }  <NL>  }  <NL>  }  <NL> if ( internal frame = = null )  <NL> return null ;  <NL> return internal frame . get document ( ) ;  <NL>  }  COM: <s> returns the currently selected document </s>