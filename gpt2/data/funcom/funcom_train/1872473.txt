TDAT: public int next ( ) {  <NL>  <NL> if ( pointer < 1 ) throw new no such element exception ( ) ;  <NL>  <NL> double d = sum * r . next double ( ) ;  <NL> int i = pointer ;  <NL> double tmp = weights [ i - 1 ] ;  <NL> while ( tmp < d & & i > 1 ) tmp + = weights [ - - i - 1 ] ;  <NL>  <NL>  / / now i - 1 is the selected element , we shift it to next position <NL> int a = buffer [ i - 1 ] ;  <NL> double b = weights [ i - 1 ] ;  <NL> buffer [ i - 1 ] = buffer [ pointer - 1 ] ;  <NL> weights [ i - 1 ] = weights [ pointer - 1 ] ;  <NL> buffer [ pointer - 1 ] = a ;  <NL> weights [ pointer - 1 ] = b ;  <NL> sum - = b ;  <NL>  <NL> return buffer [ - - pointer ] ;  <NL>  }  COM: <s> the first sample is drawn according to the probability distribution </s>