TDAT: private long run in transaction ( ) {  <NL> transaction support transaction = null ;  <NL> if ( with transaction ) {  <NL> transaction = new transaction support ( ) ;  <NL>  }  <NL> try {  <NL> long delay = do job ( ) ;  <NL> if ( transaction ! = null ) {  <NL> transaction . mark commitable ( ) ;  <NL>  }  <NL> return delay ;  <NL>  } finally {  <NL> if ( transaction ! = null ) {  <NL> transaction . close ( ) ;  <NL>  }  <NL>  }  <NL>  }  COM: <s> executes periodical task in transaction if required </s>