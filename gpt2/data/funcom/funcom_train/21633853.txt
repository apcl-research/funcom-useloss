TDAT: private double gamma ( final int n , final double [ ] g , final double [ ] grad ) {  <NL> int i ;  <NL> double denom , numer ;  <NL>  <NL> numer = denom = 0 . 0 ;  <NL>  <NL> for ( i = 0 ; i < n ; i + + ) {  <NL> denom + = g [ i ] * g [ i ] ;  <NL> numer + = ( grad [ i ] - g [ i ] ) * grad [ i ] ; / / grad is neg gradient <NL>  }  <NL>  <NL> if ( denom = = 0 . 0 ) {  <NL> return 0 . 0 ;  <NL>  } else {  <NL> return numer / denom ;  <NL>  }  <NL>  }  COM: <s> find correction for next iteration </s>