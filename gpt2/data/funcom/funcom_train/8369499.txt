TDAT: public int ber parse header ( rdp packet _ localised data , int tagval ) throws rdesktop exception {  <NL> int tag = 0 ;  <NL> int length = 0 ;  <NL> int len ;  <NL>  <NL> if ( tagval > 0x000000ff ) {  <NL> tag = data . get big endian16 ( ) ;  <NL>  } else {  <NL> tag = data . get8 ( ) ;  <NL>  }  <NL>  <NL> if ( tag ! = tagval ) {  <NL> throw new rdesktop exception ( " unexpected tag got " + tag + " expected " + tagval ) ;  <NL>  }  <NL>  <NL> len = data . get8 ( ) ;  <NL>  <NL> if ( ( len & 0x00000080 ) ! = 0 ) {  <NL> len & = ~ 0x00000080 ; / / subtract 128 <NL> length = 0 ;  <NL> while ( len - - ! = 0 ) {  <NL> length = ( length < < 8 ) + data . get8 ( ) ;  <NL>  }  <NL>  } else {  <NL> length = len ;  <NL>  }  <NL>  <NL> return length ;  <NL>  }  COM: <s> parse a ber header and determine data length </s>