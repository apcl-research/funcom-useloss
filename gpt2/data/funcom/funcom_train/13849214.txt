TDAT: private policy lookup sub policy ( final class loader ldr ) {  <NL> assert thread . holds lock ( sub policies ) ;  <NL> return ( policy ) access controller . do privileged (  <NL> new privileged action ( ) {  <NL> public object run ( ) {  <NL> for ( class loader l = ldr ; l ! = null ; l = l . get parent ( ) ) {  <NL> policy p = ( policy ) sub policies . get ( l ) ;  <NL> if ( p ! = null ) {  <NL> return p ;  <NL>  }  <NL>  }  <NL> return main policy ;  <NL>  }  <NL>  } ) ;  <NL>  }  COM: <s> returns sub policy associated with the given class loader </s>