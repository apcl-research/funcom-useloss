TDAT: protected typed position find closest position ( int offset ) {  <NL>  <NL> try {  <NL>  <NL> int index = f document . compute index in category ( f position category , offset ) ;  <NL> position [ ] category = f document . get positions ( f position category ) ;  <NL>  <NL> if ( category . length = = 0 )  <NL> return null ;  <NL>  <NL> if ( index < category . length ) {  <NL> if ( offset = = category [ index ] . offset )  <NL> return ( typed position ) category [ index ] ;  <NL>  }  <NL>  <NL> if ( index > 0 )  <NL> index - - ;  <NL>  <NL> return ( typed position ) category [ index ] ;  <NL>  <NL>  } catch ( bad position category exception x ) {  <NL>  } catch ( bad location exception x ) {  <NL>  }  <NL>  <NL> return null ;  <NL>  }  COM: <s> returns the position in the partitoners position category which is </s>