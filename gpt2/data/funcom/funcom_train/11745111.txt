TDAT: public obj entity entity matching row ( data row row ) {  <NL>  / / match depth first <NL> if ( subentities ! = null ) {  <NL> for ( entity inheritance tree child : subentities ) {  <NL> obj entity matched = child . entity matching row ( row ) ;  <NL>  <NL> if ( matched ! = null ) {  <NL> return matched ;  <NL>  }  <NL>  }  <NL>  }  <NL>  <NL> expression qualifier = get db qualifier ( ) ;  <NL> if ( qualifier ! = null ) {  <NL> return qualifier . match ( row ) ? entity : null ;  <NL>  }  <NL>  <NL>  / / no qualifier . . . matches all rows <NL> return entity ;  <NL>  }  COM: <s> returns the deepest possible entity in the inheritance hierarchy that can be used </s>