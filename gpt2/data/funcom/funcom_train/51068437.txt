TDAT: public void update faults ( router fault msg rfm ) {  <NL>  <NL> final string tag = class _ tag + " . update faults " ;  <NL> if ( debug ) debug . printtagln ( tag , " received fault : " + rfm ) ;  <NL> if ( rfm . all nodes ) {  <NL> all nodes rfm = rfm ;  <NL>  } else {  <NL> if ( rfm . node to drop = = null ) {  <NL> fault rates . put ( rfm . peer , rfm ) ;  <NL>  } else {  <NL> fault rates . put ( rfm . node to drop , rfm ) ;  <NL>  }  <NL>  }  <NL>  }  COM: <s> called when a new code router fault msg code is received </s>