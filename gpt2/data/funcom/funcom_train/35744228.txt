TDAT: protected boolean poll ( ) {  <NL>  <NL> boolean result ;  <NL> deferred action action ;  <NL>  <NL> synchronized ( state machine ) {  <NL> queue . poll ( ) ;  <NL>  <NL> if ( queue . peek ( ) = = null ) {  <NL> state machine . idle event ( ) ;  <NL> action = event called ( false ) ;  <NL> result = false ;  <NL>  } else {  <NL> state machine . msgs event ( ) ;  <NL> action = event called ( false ) ;  <NL> result = true ;  <NL>  }  <NL>  }  <NL>  <NL> notify change ( ) ;  <NL> perform deferred action ( action ) ; / / we expect none but let the state machine decide .  <NL>  <NL> return result ;  <NL>  }  COM: <s> one message done </s>