TDAT: public void _ interaction is over ( ) {  <NL> utilities . invoke later ( new runnable ( ) {  <NL> public void run ( ) {  <NL>  _ document . add to history ( _ to add to history ) ;  <NL>  _ document . set in progress ( false ) ;  <NL>  _ document . insert prompt ( ) ;  <NL>  _ notify interaction ended ( ) ;  <NL>  }  <NL>  } ) ;  <NL> scroll to caret ( ) ;  <NL>  }  COM: <s> performs the common behavior when an interaction ends </s>