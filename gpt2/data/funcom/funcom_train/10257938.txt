TDAT: protected action coalesce action ( action a ) {  <NL> action last action = get last action ( ) ;  <NL> if ( last action = = null ) return a ;  <NL> if ( last action instanceof composite action ) {  <NL> composite action ca = ( composite action ) last action ;  <NL> if ( should cluster ( ca , a ) ) {  <NL> ca . add ( a ) ;  <NL> return null ;  <NL>  }  <NL>  } else if ( should cluster ( last action , a ) ) {  <NL> composite action ca = new composite action ( a . get source ( ) ) ;  <NL> ca . add ( last action ) ;  <NL> ca . add ( a ) ;  <NL> remove last applied action ( ) ;  <NL> return ca ;  <NL>  }  <NL> return a ;  <NL>  }  COM: <s> glues similar consecutive actions together </s>