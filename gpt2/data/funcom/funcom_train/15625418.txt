TDAT: public void finish ( @ not null final undo state < g , a , r > undo state ) {  <NL> switch ( type ) {  <NL> case normal :  <NL> add undo state ( undo state ) ;  <NL> break ;  <NL>  <NL> case undo :  <NL> undo stack . set ( undo stack index , undo state ) ;  <NL> type = undo type . normal ;  <NL> break ;  <NL>  <NL> case redo :  <NL> undo stack . set ( undo stack index - 1 , undo state ) ;  <NL> type = undo type . normal ;  <NL> break ;  <NL>  }  <NL>  }  COM: <s> finishes an undo or redo operation </s>