TDAT: synchronized public void index all ( ) {  <NL> connection jdbc connection = null ;  <NL> try {  <NL>  <NL> jdbc connection = indexer helper . get jdbc connection ( data source ) ;  <NL> logger . info ( " db connection initialized " ) ;  <NL>  <NL> delete all from index ( jdbc connection ) ;  <NL> add all to index ( jdbc connection ) ;  <NL> optimize index ( ) ;  <NL>  <NL>  } catch ( sql exception sex ) {  <NL>  <NL> logger . error (  <NL>  " couldn ' t initialize database connection for indexing . " ,  <NL> sex ) ;  <NL>  <NL>  } finally {  <NL> indexer helper . close connection ( jdbc connection ) ;  <NL> logger . info ( " db connection closed " ) ;  <NL>  }  <NL>  }  COM: <s> create a jdbc connection calls index batch until it returns false using the </s>