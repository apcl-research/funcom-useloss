TDAT: public void close ( ) {  <NL> persistence manager pm = ( persistence manager ) pms . get ( ) ;  <NL> if ( pm ! = null ) {  <NL> pms . set ( null ) ;  <NL> try {  <NL> transaction t = pm . current transaction ( ) ;  <NL> if ( t . is active ( ) ) {  <NL> if ( commit on close ) {  <NL> t . commit ( ) ;  <NL>  } else {  <NL> t . rollback ( ) ;  <NL>  }  <NL>  }  <NL>  } finally {  <NL> pm . close ( ) ;  <NL>  }  <NL>  }  <NL>  }  COM: <s> closes persistence manager associated with current thread </s>