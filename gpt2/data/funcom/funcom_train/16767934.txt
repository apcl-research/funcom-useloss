TDAT: protected key pair generate key pair ( ) {  <NL> key pair key pair = null ;  <NL> dh parameter spec key spec = new dh parameter spec ( dh _ modulus , dh _ base ) ;  <NL> try {  <NL> key pair generator key gen = key pair generator . get instance ( " dh " ) ;  <NL> key gen . initialize ( key spec ) ;  <NL> key pair = key gen . generate key pair ( ) ;  <NL> key agreement = key agreement . get instance ( " dh " ) ;  <NL> key agreement . init ( key pair . get private ( ) ) ;  <NL>  } catch ( exception e ) {  <NL> log . error ( " error generating keypair " , e ) ;  <NL>  }  <NL> return key pair ;  <NL>  }  COM: <s> creates a diffie hellman key pair </s>