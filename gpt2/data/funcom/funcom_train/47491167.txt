TDAT: private connection setup connection ( ktn datagram synpack ) throws io exception {  <NL> last valid packet received = synpack ;  <NL> state = state . syn _ rcvd ;  <NL>  <NL> remote address = synpack . get src _ addr ( ) ;  <NL> remote port = synpack . get src _ port ( ) ;  <NL>  <NL>  / / sender syn _ ack <NL> send ack ( synpack , true ) ;  <NL>  / / skal f√• ack <NL> ktn datagram ret = receive ack ( ) ;  <NL> if ( ! is valid ( ret ) ) {  <NL> state = state . closed ;  <NL> throw new io exception ( " failed to setup connection " ) ;  <NL>  }  <NL> state = state . established ;  <NL> system . out . println ( " established incomming " ) ;  <NL>  <NL> return this ;  <NL>  }  COM: <s> sets up the received connection for accept </s>