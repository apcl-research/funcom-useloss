TDAT: public void density solver ( ) {  <NL>  / / add density input by mouse <NL> add source ( d , d old ) ;  <NL> swap ( d , d old ) ;  <NL>  <NL> diffusion ( 0 , d , d old , diffusion ) ;  <NL> swap ( d , d old ) ;  <NL>  <NL> advect ( 0 , d , d old , u , v ) ;  <NL>  <NL>  / / clear input density array for next frame <NL> for ( int i = 0 ; i < size ; i + + ) {  <NL> d old [ i ] = 0 ;  <NL>  }  <NL>  }  COM: <s> the basic density solving routine </s>