TDAT: protected boolean has listen service permission ( service event event ) {  <NL> protection domain domain = bundle . get protection domain ( ) ;  <NL>  <NL> if ( domain ! = null ) {  <NL> service reference impl reference = ( service reference impl ) event . get service reference ( ) ;  <NL>  <NL> string [ ] names = reference . registration . clazzes ;  <NL>  <NL> int len = names . length ;  <NL>  <NL> for ( int i = 0 ; i < len ; i + + ) {  <NL> if ( domain . implies ( new service permission ( names [ i ] , service permission . get ) ) ) {  <NL> return true ;  <NL>  }  <NL>  }  <NL>  <NL> return false ;  <NL>  }  <NL>  <NL> return ( true ) ;  <NL>  }  COM: <s> check for permission to listen to a service </s>