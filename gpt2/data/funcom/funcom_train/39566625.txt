TDAT: public void stop ( ) {  <NL> synchronized ( state guard )  <NL>  {  <NL> while ( true )  <NL>  {  <NL> if ( state = = started )  <NL>  {  <NL> state = stopping ;  <NL> break ;  <NL>  }  <NL> else if ( state = = stopped )  <NL>  {  <NL> throw new illegal state exception ( " tried to stop message store twice ! " ) ;  <NL>  }  <NL>  <NL> try {  <NL> state guard . wait ( ) ;  <NL>  }  <NL> catch ( interrupted exception ie )  <NL>  {  <NL>  }  <NL>  }  <NL>  }  <NL>  <NL> my stop ( ) ;  <NL>  <NL> synchronized ( state guard )  <NL>  {  <NL> state = stopped ;  <NL> state guard . notify ( ) ;  <NL>  }  <NL>  }  COM: <s> stop the thread </s>