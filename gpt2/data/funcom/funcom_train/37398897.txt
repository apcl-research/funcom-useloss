TDAT: public void check ( string [ ] roles ) throws authentication exception {  <NL> for ( int i = 0 ; i < roles . length ; i + + ) {  <NL> string role = roles [ i ] ;  <NL> if ( role . ends with ( authenticated ) ) {  <NL> if ( is authenticated ( ) ) {  <NL> return ;  <NL>  }  <NL>  } else {  <NL> if ( is in role ( role ) ) {  <NL> return ;  <NL>  }  <NL>  }  <NL>  }  <NL> throw new authentication exception ( message _ user _ not _ in _ role ) ;  <NL>  }  COM: <s> p method called for security check failure </s>