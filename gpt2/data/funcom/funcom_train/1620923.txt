TDAT: public i resource extract selection ( i selection sel ) {  <NL> if ( ! ( sel instanceof i structured selection ) )  <NL> return null ;  <NL> i structured selection ss = ( i structured selection ) sel ;  <NL> object element = ss . get first element ( ) ;  <NL> if ( element instanceof i resource )  <NL> return ( i resource ) element ;  <NL> if ( ! ( element instanceof i adaptable ) )  <NL> return null ;  <NL> i adaptable adaptable = ( i adaptable ) element ;  <NL> object adapter = adaptable . get adapter ( i resource . class ) ;  <NL> return ( i resource ) adapter ;  <NL>  }  COM: <s> returns the selected resource </s>