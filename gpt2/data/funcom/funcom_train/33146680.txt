TDAT: private byte buffer chars to bytes ( char buffer chars , byte buffer bytes ) {  <NL> bytes . clear ( ) ;  <NL> final int max capacity = ( int ) ( chars . remaining ( ) * encoder <NL>  . max bytes per char ( ) ) ;  <NL> if ( bytes . capacity ( ) < = max capacity ) {  <NL> bytes = byte buffer . allocate ( max capacity ) ;  <NL>  }  <NL>  <NL> chars . mark ( ) ;  <NL> encoder . reset ( ) ;  <NL> if ( encoder . encode ( chars , bytes , true ) .  <NL> is error ( ) ) { / / remove everything , we don ' t want to accept malformed intput <NL> bytes . clear ( ) ;  <NL>  }  <NL> bytes . flip ( ) ;  <NL> chars . reset ( ) ;  <NL>  <NL> return bytes ;  <NL>  }  COM: <s> encode a character sequence into a byte buffer optionally expanding </s>