TDAT: public string subscribe ( string topic , listener listener , map options ) {  <NL> string route _ id = null ;  <NL> string random = get message id ( ) ;  <NL> list listeners ;  <NL>  <NL> if ( this = = listener )  <NL> throw new runtime exception ( " circular subscription " ) ;  <NL>  <NL>  / / generate magic route id <NL> route _ id = get route id ( topic , random ) ;  <NL> routes . put ( route _ id , listener ) ;  <NL>  <NL>  / / add to list of listeners for this topic <NL> listeners = get listeners ( topic ) ;  <NL> if ( listeners = = null )  <NL>  {  <NL> listeners = new array list ( ) ;  <NL> topics . put ( topic , listeners ) ;  <NL>  }  <NL> listeners . add ( listener ) ;  <NL>  <NL> return route _ id ;  <NL>  }  COM: <s> subscribe the listener to the specified topic </s>