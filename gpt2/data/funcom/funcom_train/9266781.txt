TDAT: public void close ( ) {  <NL> if ( get state ( ) = = socket _ state . established ) {  <NL> if ( tx buffer . is empty ( ) ) {  <NL> queue packet with kernel (  <NL> ntp packet . new fin packet ( src port , dest port , get next seq no ( ) ) ) ;  <NL> set state ( socket _ state . closing ) ;  <NL>  } else {  <NL> queue packet with kernel (  <NL> ntp packet . new stp packet ( src port , dest port , get next seq no ( ) ) ) ;  <NL> set state ( socket _ state . stp _ sent ) ;  <NL>  }  <NL>  } else if ( get state ( ) = = socket _ state . stp _ rcvd ) {  <NL> queue packet with kernel (  <NL> ntp packet . new fin packet ( src port , dest port , get next seq no ( ) ) ) ;  <NL> set state ( socket _ state . closing ) ;  <NL>  }  <NL>  }  COM: <s> handles the close action in the fsa for the nachos protocol </s>