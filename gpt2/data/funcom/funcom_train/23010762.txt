TDAT: public void map updated ( ) {  <NL>  <NL>  <NL>  / / set map ( ) and set layers ( ) must be called first . .  <NL> if ( items = = null )  <NL> return ;  <NL>  <NL> update item bounds ( ) ;  <NL>  / / if ( true ) return ;  <NL>  <NL> update item locations ( ) ;  <NL>  / / if ( true ) return ;  <NL>  <NL> layer lyr = map . get active layer ( ) ;  <NL> if ( lyr ! = null ) {  <NL> select item ( lyr . id ) ;  <NL>  }  <NL>  <NL> repaint needed = true ;  <NL>  <NL> repaint ( ) ;  <NL>  }  COM: <s> repaint legend in response on following map events </s>