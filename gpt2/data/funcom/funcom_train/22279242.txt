TDAT: public range selected range ( ) {  <NL>  <NL> if ( _ selected range = = null )  <NL>  _ selected range = allocate range ( ) ;  <NL>  <NL>  _ selected range . index = _ selection . selection start ( ) ;  <NL> if ( _ selected range . index < 0 )  <NL> return allocate range ( ) ;  <NL>  _ selected range . length = _ selection . selection end ( ) -  <NL>  _ selection . selection start ( ) ;  <NL> return _ selected range ;  <NL>  }  COM: <s> returns the selected range </s>