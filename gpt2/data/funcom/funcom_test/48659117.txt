TDAT: public void reset password ( string token , string old password , string new password ) throws exception {  <NL> account manager am = new account manager ( ) ;  <NL> account acct = am . check token ( token ) ;  <NL> if ( ! old password . equals ignore case ( acct . get password ( ) ) ) {  <NL> am . close session ( ) ;  <NL> throw new il exception ( il exception . bad _ password ) ;  <NL>  }  <NL> acct . set password ( new password ) ;  <NL> acct . set email token ( " " ) ;  <NL> am . save or update account ( acct ) ;  <NL> am . close session ( ) ;  <NL>  }  COM: <s> resets the password for the account identified by the security token </s>