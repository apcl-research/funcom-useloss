TDAT: public string gen secret key for user ( user user , byte [ ] pub key ) throws invalid key exception {  <NL> public key pkey = encoded string to public key ( pub key ) ;  <NL> byte [ ] key = gen secret key ( ) ;  <NL> log . info ( " saving keys for user : " + user ) ;  <NL> this . key cache . put ( user . get login ( ) , new key time ( key ) ) ;  <NL> byte [ ] enckey = encrypt secret key ( pkey , key ) ;  <NL> string enc key str = encode url safe ( enckey ) ;  <NL> return enc key str ;  <NL>  }  COM: <s> generates a random secret key for the user </s>