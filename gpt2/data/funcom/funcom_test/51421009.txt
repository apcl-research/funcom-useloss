TDAT: private void ensure state ( string name ) throws exception {  <NL>  / / ystem . out . println ( " ensure state " + get name ( ) + " : : " + name ) ;  <NL> if ( parent state ! = null ) {  <NL> parent region manager . ensure state ( parent state ) ;  <NL>  }  <NL> state target = machine . get state ( name ) ;  <NL>  <NL> if ( target = = this . machine . get current state ( ) ) return ;  <NL>  / / place for improvement here : just iterate looking for ' target ' upwards on <NL> state ancestor = compute common ancestor ( this . machine . get current state ( ) , target ) ;  <NL> if ( ancestor = = target ) return ;  <NL> set state ( name ) ;  <NL>  }  COM: <s> ensure state sets the target state only when it is not already active </s>