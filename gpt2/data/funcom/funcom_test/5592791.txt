TDAT: public int read ( ) throws io exception {  <NL>  <NL>  / / check if the segment index is bigger than the total count .  <NL>  / / if so , load a new segment .  <NL> if ( index > = segment . offset + segment . count ) {  <NL> if ( doc pos > = p1 ) {  <NL>  / / no more data <NL> return - 1 ;  <NL>  }  <NL> load segment ( ) ;  <NL>  }  <NL> return segment . array [ index + + ] ;  <NL>  } / / end read  COM: <s> reads the next byte of data from this input stream </s>