TDAT: public void update rate ( data amount , time now ) {  <NL> time old time = last . subtract ( rate since ) ;  <NL> data old data = converter . get data ( rate , old time ) ;  <NL> data all data = old data . add ( amount ) ;  <NL> time all time = now . subtract ( rate since ) . add ( time . in milliseconds ( 0 . 001 ) ) ;  <NL>  <NL> rate = converter . get bandwidth ( all data , all time ) ;  <NL> last = now ;  <NL> if ( rate since . is lower than ( now . subtract ( max rate period ) ) ) {  <NL> rate since = now . subtract ( max rate period ) ;  <NL>  }  <NL>  }  COM: <s> updates the traffic rate with code amount code at time </s>