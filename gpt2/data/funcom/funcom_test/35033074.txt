TDAT: private void validate file ( byte [ ] data ) throws decryption failed exception {  <NL> int min size = offset _ header + 32 + length _ eof + length _ hmac ;  <NL> if ( data . length < min size || ( data . length - 8 ) % 16 ! = 0 <NL> || ! " pws3 " . equals ( tag ( data ) ) ) {  <NL> throw new decryption failed exception ( " the data is not a valid "  <NL>  + " password safe v3 database " ) ;  <NL>  }  <NL>  }  COM: <s> checks the data length and for the pws3 tag </s>