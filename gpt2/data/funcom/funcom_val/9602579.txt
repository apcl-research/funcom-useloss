TDAT: public int get number of sheets ( ) throws biff exception , io exception , invalid format exception {  <NL> if ( get file ( ) . get absolute path ( ) . ends with ( " . xlsx " ) ) {  <NL>  / / excel 2007 file <NL> if ( workbook poi = = null ) {  <NL> create workbook poi ( ) ;  <NL>  }  <NL> return workbook poi . get number of sheets ( ) ;  <NL>  } else {  <NL>  / / excel pre 2007 file <NL> if ( workbook jxl = = null ) {  <NL> create workbook jxl ( ) ;  <NL>  }  <NL> return workbook jxl . get number of sheets ( ) ;  <NL>  }  <NL>  }  COM: <s> returns the number of sheets in the excel file </s>