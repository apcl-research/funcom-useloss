TDAT: private int index lower ( float x , int x max ) {  <NL> if ( is periodic & & x max > 0 ) {  <NL> while ( x < 0 )  <NL> x + = x max ;  <NL> while ( x > = x max )  <NL> x - = x max ;  <NL> return ( int ) x ;  <NL>  }  <NL> if ( x < 0 )  <NL> return 0 ;  <NL> int floor = ( int ) x ;  <NL> return ( floor > x max ? x max : floor ) ;  <NL>  }  COM: <s> periodic grids should have val 0 val x max </s>