TDAT: private object open databases ( boolean create ) {  <NL>  <NL>  / / open all databases <NL> open databases ( true , create ) ;  <NL> boolean success = false ;  <NL> try {  <NL> open databases ( false , create ) ;  <NL> success = true ;  <NL>  } finally {  <NL> if ( ! success )  <NL> close databases ( true ) ;  <NL>  }  <NL>  <NL>  / / set open token <NL> object token = new object ( ) ;  <NL> for ( entity < ? > entity : get sorted entities ( ) )  <NL> entity . set open token ( token ) ;  <NL> return token ;  <NL>  }  COM: <s> open bdb databases un doing on failure </s>